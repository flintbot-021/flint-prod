"use strict";exports.id=605,exports.ids=[605],exports.modules={7938:(e,s,a)=>{a.d(s,{v:()=>l});var t=a(43210);function l(e,s={}){let{autoSave:a=!0,autoSaveDelay:i=500,validation:r,onSave:n,onCancel:c,onEdit:o,placeholder:d="",multiline:m=!1,maxLength:x,required:u=!1}=s,[h,p]=(0,t.useState)(!1),[g,b]=(0,t.useState)(e),[j,v]=(0,t.useState)(null),[f,N]=(0,t.useState)(!1),[w,y]=(0,t.useState)(e),C=(0,t.useRef)(null);var k=g,A=0;let[V,S]=(0,t.useState)(k),z=g!==w,$=(0,t.useCallback)(e=>u&&!e.trim()?"This field is required":x&&e.length>x?`Maximum length is ${x} characters`:r?r(e):null,[u,x,r]),R=(0,t.useCallback)(()=>{p(!0),y(g),v(null),o?.(),setTimeout(()=>{C.current?.focus(),C.current&&"select"in C.current&&C.current.select()},0)},[g,o]),I=(0,t.useCallback)(async()=>{if(j)return;let e=$(g);if(e)return void v(e);try{N(!0),await n?.(g),y(g),p(!1),v(null)}catch(e){v(e instanceof Error?e.message:"Failed to save")}finally{N(!1)}},[g,j,$,n]),E=(0,t.useCallback)(()=>{b(w),p(!1),v(null),c?.()},[w,c]),T=(0,t.useCallback)(e=>{switch(e.key){case"Enter":(!m||m&&e.ctrlKey)&&(e.preventDefault(),I());break;case"Escape":e.preventDefault(),E();break;case"Tab":j||I()}},[I,E,m,j]),M=(0,t.useCallback)(()=>{!j&&z?I():z||p(!1)},[j,z,I]),P=g||d;return{isEditing:h,value:g,displayValue:P,error:j,isSaving:f,isDirty:z,startEdit:R,save:I,cancel:E,setValue:b,handleKeyDown:T,handleBlur:M,inputRef:C}}},15616:(e,s,a)=>{a.d(s,{T:()=>i});var t=a(60687);a(43210);var l=a(96241);function i({className:e,...s}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...s})}},39390:(e,s,a)=>{a.d(s,{J:()=>r});var t=a(60687);a(43210);var l=a(78148),i=a(96241);function r({className:e,...s}){return(0,t.jsx)(l.b,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...s})}},42902:(e,s,a)=>{a.d(s,{d:()=>r});var t=a(60687);a(43210);var l=a(90270),i=a(96241);function r({className:e,...s}){return(0,t.jsx)(l.bL,{"data-slot":"switch",className:(0,i.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:(0,t.jsx)(l.zi,{"data-slot":"switch-thumb",className:(0,i.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},68988:(e,s,a)=>{a.d(s,{p:()=>r});var t=a(60687),l=a(43210),i=a(96241);let r=l.forwardRef(({className:e,type:s,...a},l)=>(0,t.jsx)("input",{type:s,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:l,...a}));r.displayName="Input"},70605:(e,s,a)=>{a.d(s,{x:()=>eC});var t=a(60687),l=a(43210),i=a(96241),r=a(55192),n=a(24934),c=a(68988),o=a(39390),d=a(59821),m=a(42902),x=a(31158),u=a(25334),h=a(28947),p=a(13861),g=a(80375),b=a(7938),j=a(85167),v=a(5336),f=a(64021);function N({children:e,className:s,lockedTitle:a="Results Locked",lockedMessage:l="Complete the form above to unlock your personalized results.",showProgress:n=!0}){let{isResultsLocked:c,canAccessResults:o,captureCompleted:d}=(0,j.iB)();return o?(0,t.jsx)(t.Fragment,{children:e}):(0,t.jsxs)("div",{className:(0,i.cn)("relative",s),children:[(0,t.jsx)("div",{className:"filter blur-sm pointer-events-none select-none opacity-30",children:e}),(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,t.jsxs)(r.Zp,{className:"w-full max-w-md mx-auto bg-white/95 backdrop-blur-sm border-2 border-gray-200 shadow-lg",children:[(0,t.jsxs)(r.aR,{className:"text-center space-y-3",children:[(0,t.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:d?(0,t.jsx)(v.A,{className:"h-8 w-8 text-green-600"}):(0,t.jsx)(f.A,{className:"h-8 w-8 text-gray-600"})}),(0,t.jsx)(r.ZB,{className:"text-xl font-bold text-gray-900",children:a})]}),(0,t.jsxs)(r.Wu,{className:"text-center space-y-4",children:[(0,t.jsx)("p",{className:"text-gray-600",children:l}),n&&(0,t.jsx)("div",{className:"space-y-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[(0,t.jsx)("div",{className:(0,i.cn)("w-3 h-3 rounded-full",d?"bg-green-500":"bg-gray-300")}),(0,t.jsx)("span",{children:"Form Completion"})]})})]})]})})]})}var w=a(35071),y=a(12597),C=a(93613),k=a(78122);let A={enableConditionalContent:!0,enableFormatting:!0,enableNestedAccess:!0,strictMode:!1,maxDepth:5,missingVariablePlaceholder:"[variable not found]"},V={uppercase:{name:"uppercase",description:"Convert text to uppercase",example:"@name | uppercase",formatter:e=>String(e).toUpperCase()},lowercase:{name:"lowercase",description:"Convert text to lowercase",example:"@name | lowercase",formatter:e=>String(e).toLowerCase()},capitalize:{name:"capitalize",description:"Capitalize first letter of each word",example:"@name | capitalize",formatter:e=>String(e).replace(/\b\w/g,e=>e.toUpperCase())},currency:{name:"currency",description:"Format number as currency",example:"@price | currency",formatter:(e,s={currency:"USD"})=>{let a=Number(e);return isNaN(a)?String(e):new Intl.NumberFormat("en-US",{style:"currency",currency:s.currency}).format(a)}},date:{name:"date",description:"Format date value",example:"@created_at | date",formatter:(e,s={dateStyle:"medium"})=>{let a=new Date(e);return isNaN(a.getTime())?String(e):a.toLocaleDateString("en-US",s)}},truncate:{name:"truncate",description:"Truncate text to specified length",example:"@description | truncate:100",formatter:(e,s={length:50})=>{let a=String(e);return a.length>s.length?a.substring(0,s.length)+"...":a}}},S={basic:/@([a-zA-Z_][a-zA-Z0-9_]*)/g,nested:/@([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)/g,formatted:/@([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\s*\|\s*([a-zA-Z_][a-zA-Z0-9_]*(?::[^@\|\}]+)?)/g,conditional:/\{if\s+@([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\s*([=!<>]+\s*[^}]+)?\}([\s\S]*?)\{\/if\}/g};class z{constructor(e={}){this.options={...A,...e},this.formatters={},Object.entries(V).forEach(([e,s])=>{this.formatters[e]=s.formatter})}interpolate(e,s){let a={success:!0,content:e,processedVariables:[],missingVariables:[],errors:[],warnings:[],usedConditionalRules:[]};try{let t=this.parseVariableReferences(e);t.errors.length>0&&a.errors.push(...t.errors),t.warnings.length>0&&a.warnings.push(...t.warnings);let l=e;this.options.enableConditionalContent&&(l=this.processConditionalContent(l,s,a)),l=this.replaceVariableReferences(l,s,a),a.content=l,a.success=0===a.errors.length}catch(e){a.success=!1,a.errors.push(`Interpolation failed: ${e instanceof Error?e.message:"Unknown error"}`)}return a}parseVariableReferences(e){let s={variables:[],blocks:[],errors:[],warnings:[]};try{let a=[{type:"formatted",regex:S.formatted},{type:"nested",regex:S.nested},{type:"basic",regex:S.basic}],t=new Set;a.forEach(({type:a,regex:l})=>{let i,r=new RegExp(l.source,l.flags);for(;null!==(i=r.exec(e));){i[0];let e=i[1],l="formatted"===a?i[2]:void 0;if(!t.has(e)){t.add(e);let a={name:e,path:e.includes(".")?e.split("."):void 0,formatter:l};s.variables.push(a)}}})}catch(e){s.errors.push(`Failed to parse variable references: ${e instanceof Error?e.message:"Unknown error"}`)}return s}addFormatter(e,s){this.formatters[e]=s}processConditionalContent(e,s,a){let t=new RegExp(S.conditional.source,S.conditional.flags);return e.replace(t,(e,t,l,i)=>{try{let e=this.getVariableValue(t,s);if(this.evaluateCondition(t,e,l,s))return a.usedConditionalRules.push(`if ${t}`),i;return""}catch(s){return a.warnings.push(`Failed to process conditional content for ${t}: ${s instanceof Error?s.message:"Unknown error"}`),e}})}replaceVariableReferences(e,s,a){return e=(e=e.replace(S.formatted,(e,t,l)=>this.processVariableReplacement(t,s,a,l))).replace(S.basic,(t,l)=>e.includes(`@${l} |`)||e.includes(`@${l}|`)?t:this.processVariableReplacement(l,s,a))}processVariableReplacement(e,s,a,t){try{let l=this.getVariableValue(e,s);if(null==l)return a.missingVariables.push(e),this.options.missingVariablePlaceholder||`[${e} not found]`;if(a.processedVariables.push(e),t&&this.options.enableFormatting)return this.applyFormatter(l,t,a);return this.formatValue(l)}catch(s){return a.errors.push(`Failed to process variable ${e}: ${s instanceof Error?s.message:"Unknown error"}`),`[Error: ${e}]`}}getVariableValue(e,s){if(!this.options.enableNestedAccess||!e.includes("."))return s.variables[e];let a=e.split("."),t=s.variables[a[0]];for(let e=1;e<a.length&&null!=t;e++)if("object"!=typeof t||!(a[e]in t))return;else t=t[a[e]];return t}applyFormatter(e,s,a){try{let[t,l]=s.split(":"),i=this.formatters[t];if(!i)return a.warnings.push(`Unknown formatter: ${t}`),this.formatValue(e);let r={};if(l)try{l.includes("=")?l.split(",").forEach(e=>{let[s,a]=e.split("=");s&&a&&(r[s.trim()]=isNaN(Number(a))?a.trim():Number(a))}):r={length:Number(l)}}catch{}return i(e,r)}catch(s){return a.warnings.push(`Formatter error: ${s instanceof Error?s.message:"Unknown error"}`),this.formatValue(e)}}formatValue(e){return null==e?"":"object"==typeof e?JSON.stringify(e):String(e)}evaluateCondition(e,s,a,t){if(!a)return null!=s&&""!==s;try{let e=a.trim();if(e.startsWith("=")){let a=e.substring(1).trim();return String(s)===a}if(e.startsWith("!=")){let a=e.substring(2).trim();return String(s)!==a}if(e.startsWith(">")){let a=e.substring(1).trim();return Number(s)>Number(a)}if(e.startsWith("<")){let a=e.substring(1).trim();return Number(s)<Number(a)}return null!=s&&""!==s}catch{return null!=s&&""!==s}}}function $({result:e,isVisible:s,onToggle:a}){return s?(0,t.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded border space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Interpolation Debug Info"}),(0,t.jsx)(n.$,{variant:"ghost",size:"sm",onClick:a,className:"h-6 px-2",children:(0,t.jsx)(y.A,{className:"h-3 w-3"})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(d.E,{variant:e.success?"default":"destructive",children:e.success?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.A,{className:"h-3 w-3 mr-1"}),"Success"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"Failed"]})}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:[e.processedVariables.length," processed • ",e.missingVariables.length," missing"]})]}),e.processedVariables.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Processed Variables:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.processedVariables.map((e,s)=>(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs bg-green-50 text-green-700",children:["@",e]},s))})]}),e.missingVariables.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-medium text-amber-700 mb-1",children:"Missing Variables:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.missingVariables.map((e,s)=>(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs bg-amber-50 text-amber-700",children:["@",e]},s))})]}),e.usedConditionalRules.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"Applied Rules:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.usedConditionalRules.map((e,s)=>(0,t.jsx)(d.E,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:e},s))})]}),e.errors.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-medium text-red-700 mb-1",children:"Errors:"}),(0,t.jsx)("div",{className:"space-y-1",children:e.errors.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start space-x-1 text-xs text-red-600",children:[(0,t.jsx)(C.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:e})]},s))})]}),e.warnings.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-medium text-amber-700 mb-1",children:"Warnings:"}),(0,t.jsx)("div",{className:"space-y-1",children:e.warnings.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-start space-x-1 text-xs text-amber-600",children:[(0,t.jsx)(C.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:e})]},s))})]})]}):(0,t.jsxs)("div",{className:"flex items-center justify-between mt-2 p-2 bg-gray-50 rounded border",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(d.E,{variant:e.success?"default":"destructive",className:"text-xs",children:e.success?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(v.A,{className:"h-3 w-3 mr-1"}),"Success"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w.A,{className:"h-3 w-3 mr-1"}),"Failed"]})}),(0,t.jsxs)("div",{className:"text-xs text-gray-600",children:[e.processedVariables.length," variables processed",e.missingVariables.length>0&&(0,t.jsxs)("span",{className:"text-amber-600 ml-1",children:["• ",e.missingVariables.length," missing"]})]})]}),(0,t.jsx)(n.$,{variant:"ghost",size:"sm",onClick:a,className:"h-6 px-2",children:(0,t.jsx)(p.A,{className:"h-3 w-3"})})]})}function R({content:e,highlightVariables:s}){if(!s)return(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:e}});let a=e.replace(/\[@([^\]]+) not found\]/g,'<span class="bg-red-100 text-red-700 px-1 rounded text-sm">[$1 not found]</span>').replace(/\[Error: ([^\]]+)\]/g,'<span class="bg-red-100 text-red-700 px-1 rounded text-sm">[Error: $1]</span>');return(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:a}})}function I({content:e,context:s,className:a,showPreview:r=!1,showDebugInfo:n=!1,onInterpolationResult:c,enableRealTimeProcessing:o=!0,fallbackContent:d="",highlightVariables:m=!1}){let[x,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(!1),g=(0,l.useMemo)(()=>new z,[]),b=(0,l.useMemo)(()=>{if(!o)return{success:!0,content:e,processedVariables:[],missingVariables:[],errors:[],warnings:[],usedConditionalRules:[]};p(!0);try{return g.interpolate(e,s)}catch(s){return{success:!1,content:d||e,processedVariables:[],missingVariables:[],errors:[`Processing failed: ${s instanceof Error?s.message:"Unknown error"}`],warnings:[],usedConditionalRules:[]}}finally{p(!1)}},[e,s,g,o,d]),j=(0,l.useMemo)(()=>r&&b.success?b.content:e,[r,b,e]);return(0,t.jsxs)("div",{className:(0,i.cn)("space-y-2",a),children:[h&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,t.jsx)(k.A,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)("span",{children:"Processing variables..."})]}),(0,t.jsx)("div",{className:(0,i.cn)("prose prose-sm max-w-none",!b.success&&"bg-red-50 border border-red-200 rounded p-3"),children:(0,t.jsx)(R,{content:j,highlightVariables:m})}),!b.success&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-red-600",children:[(0,t.jsx)(w.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Variable interpolation failed"})]}),b.missingVariables.length>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-amber-600",children:[(0,t.jsx)(C.A,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:[b.missingVariables.length," variables missing"]})]}),n&&(0,t.jsx)($,{result:b,isVisible:x,onToggle:()=>u(!x)})]})}var E=a(75034),T=a(9005),M=a(49153),P=a(79351),F=a(11860),W=a(8819),L=a(13964),U=a(15616),_=a(27777),D=a(11922),Z=a(15574),J=a(25366),H=a(14290),B=a(47342),O=a(31541),q=a(29838),K=a(78272),Y=a(14952),G=a(65668);let Q=[{id:"bold",label:"Bold Text",description:"Make text bold",icon:_.A,syntax:"**text**",example:"**Important note**"},{id:"italic",label:"Italic Text",description:"Make text italic",icon:D.A,syntax:"*text*",example:"*Emphasis here*"},{id:"heading",label:"Heading",description:"Create a heading",icon:Z.A,syntax:"# Heading",example:"# Section Title"},{id:"list",label:"Bullet List",description:"Create a bullet list",icon:J.A,syntax:"- Item",example:"- First item\n- Second item"},{id:"numbered",label:"Numbered List",description:"Create a numbered list",icon:H.A,syntax:"1. Item",example:"1. First step\n2. Second step"},{id:"link",label:"Link",description:"Create a hyperlink",icon:B.A,syntax:"[text](url)",example:"[Visit our website](https://example.com)"},{id:"variable",label:"Variable",description:"Insert a variable",icon:O.A,syntax:"@variableName",example:"@name, @email, @score"},{id:"conditional",label:"Conditional Content",description:"Show content based on conditions",icon:q.A,syntax:"{if @variable}content{/if}",example:"{if @score > 80}Excellent!{/if}"}],X=[{value:">",label:"Greater than"},{value:"<",label:"Less than"},{value:">=",label:"Greater than or equal"},{value:"<=",label:"Less than or equal"},{value:"=",label:"Equal to"},{value:"!=",label:"Not equal to"},{value:"contains",label:"Contains"},{value:"starts_with",label:"Starts with"},{value:"ends_with",label:"Ends with"}];function ee({onInsert:e,enableVariables:s=!0,enableConditionals:a=!0}){let l=Q.filter(e=>(!!s||"variable"!==e.id)&&(!!a||"conditional"!==e.id));return(0,t.jsx)("div",{className:"flex flex-wrap gap-1 p-2 bg-gray-50 border-b",children:l.map(s=>{let a=s.icon;return(0,t.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>e(s.syntax),className:"h-8 px-2",title:`${s.label}: ${s.syntax}`,children:(0,t.jsx)(a,{className:"h-3 w-3"})},s.id)})})}function es({onInsert:e,availableVariables:s=[]}){let[a,i]=(0,l.useState)({id:Date.now().toString(),variable:"",operator:">",value:"",content:""}),[d,m]=(0,l.useState)(!1);return(0,t.jsxs)(r.Zp,{className:"border-dashed",children:[(0,t.jsx)(r.aR,{className:"cursor-pointer py-3",onClick:()=>m(!d),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(q.A,{className:"h-4 w-4 text-blue-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Conditional Content"})]}),d?(0,t.jsx)(K.A,{className:"h-4 w-4"}):(0,t.jsx)(Y.A,{className:"h-4 w-4"})]})}),d&&(0,t.jsxs)(r.Wu,{className:"pt-0 space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs",children:"Variable"}),(0,t.jsxs)("select",{value:a.variable,onChange:e=>i({...a,variable:e.target.value}),className:"w-full text-sm border rounded px-2 py-1",children:[(0,t.jsx)("option",{value:"",children:"Select variable..."}),s.map(e=>(0,t.jsxs)("option",{value:e,children:["@",e]},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs",children:"Operator"}),(0,t.jsx)("select",{value:a.operator,onChange:e=>i({...a,operator:e.target.value}),className:"w-full text-sm border rounded px-2 py-1",children:X.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs",children:"Value"}),(0,t.jsx)(c.p,{value:a.value,onChange:e=>i({...a,value:e.target.value}),placeholder:"Comparison value...",className:"text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs",children:"Content to show"}),(0,t.jsx)(U.T,{value:a.content,onChange:e=>i({...a,content:e.target.value}),placeholder:"Content to display when condition is true...",className:"text-sm",rows:2})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>m(!1),children:"Cancel"}),(0,t.jsx)(n.$,{size:"sm",onClick:()=>{a.variable&&a.content&&(e(`{if @${a.variable} ${a.operator} ${a.value}}${a.content}{/if}`),i({id:Date.now().toString(),variable:"",operator:">",value:"",content:""}),m(!1))},disabled:!a.variable||!a.content,children:"Insert Conditional"})]})]})]})}function ea(){let[e,s]=(0,l.useState)(!1);return(0,t.jsxs)(r.Zp,{className:"border-blue-200 bg-blue-50",children:[(0,t.jsx)(r.aR,{className:"cursor-pointer py-3",onClick:()=>s(!e),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(G.A,{className:"h-4 w-4 text-blue-600"}),(0,t.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Formatting Help"})]}),e?(0,t.jsx)(K.A,{className:"h-4 w-4 text-blue-600"}):(0,t.jsx)(Y.A,{className:"h-4 w-4 text-blue-600"})]})}),e&&(0,t.jsxs)(r.Wu,{className:"pt-0 space-y-3",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 gap-2 text-xs",children:Q.map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,t.jsxs)("span",{className:"text-blue-800",children:[e.label,":"]}),(0,t.jsx)("code",{className:"bg-white px-2 py-1 rounded border text-blue-900",children:e.syntax})]},e.id))}),(0,t.jsx)("div",{className:"mt-3 pt-3 border-t border-blue-200",children:(0,t.jsxs)("div",{className:"text-xs text-blue-700",children:[(0,t.jsx)("strong",{children:"Variable Examples:"}),(0,t.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("code",{className:"bg-white px-1 rounded",children:"@name"})," - User's name"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("code",{className:"bg-white px-1 rounded",children:"@score"})," - Calculated score"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("code",{className:"bg-white px-1 rounded",children:"@recommendation"})," - AI recommendation"]})]})]})})]})]})}function et({content:e,onChange:s,variableContext:a,className:c,placeholder:m="Enter your content...",enablePreview:x=!0,enableVariables:u=!0,enableFormatting:h=!0,enableConditionals:g=!0,maxHeight:b="400px"}){let[j,v]=(0,l.useState)(!1),[f,N]=(0,l.useState)(!1),w=(0,l.useRef)(null),y=(0,l.useMemo)(()=>a?.availableVariables?.map(e=>e.name)||[],[a?.availableVariables]),C=(0,l.useCallback)(a=>{if(!w.current)return;let t=w.current,l=t.selectionStart,i=t.selectionEnd,r=e.substring(l,i),n=e,c=l;if(a.includes("text")){let s=a.replace("text",r||"text");n=e.substring(0,l)+s+e.substring(i),c=l+s.length}else if(a.includes("url")){let s=a.replace("text",r||"link text");n=e.substring(0,l)+s+e.substring(i),c=l+s.indexOf("url")}else n=e.substring(0,l)+a+e.substring(i),c=l+a.length;s(n),setTimeout(()=>{w.current&&(w.current.focus(),w.current.setSelectionRange(c,c))},0)},[e,s]),k=(0,l.useCallback)(a=>{if(!w.current)return;let t=w.current.selectionStart;s(e.substring(0,t)+a+e.substring(t)),setTimeout(()=>{w.current&&(w.current.focus(),w.current.setSelectionRange(t+a.length,t+a.length))},0)},[e,s]);return(0,t.jsxs)("div",{className:(0,i.cn)("space-y-3",c),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(o.J,{className:"text-sm font-medium",children:"Content Editor"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>N(!f),children:[(0,t.jsx)(G.A,{className:"h-4 w-4 mr-1"}),"Help"]}),x&&(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>v(!j),children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-1"}),j?"Edit":"Preview"]})]})]}),f&&(0,t.jsx)(ea,{}),(0,t.jsxs)(r.Zp,{children:[h&&!j&&(0,t.jsx)(ee,{onInsert:C,enableVariables:u,enableConditionals:g}),(0,t.jsx)(r.Wu,{className:"p-0",children:j?(0,t.jsx)("div",{className:"p-4 min-h-[200px]",children:a?(0,t.jsx)(I,{content:e,context:a,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:!0}):(0,t.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})})}):(0,t.jsx)(U.T,{ref:w,value:e,onChange:e=>s(e.target.value),placeholder:m,className:"border-0 resize-none focus:ring-0 text-sm",style:{maxHeight:b,minHeight:"200px"}})})]}),g&&!j&&(0,t.jsx)(es,{onInsert:k,availableVariables:y}),u&&y.length>0&&!j&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600",children:"Available Variables:"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[y.slice(0,8).map(e=>(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>C(`@${e}`),className:"h-6 px-2 text-xs",children:[(0,t.jsx)(O.A,{className:"h-3 w-3 mr-1"}),e]},e)),y.length>8&&(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs",children:["+",y.length-8," more"]})]})]})]})}var el=a(95999),ei=a(80051),er=a(8366),en=a(17740),ec=a(98687),eo=a(16023),ed=a(18179);let em=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},ex=()=>`img_${Date.now()}_${Math.random().toString(36).substring(2,15)}`;function eu({image:e,onUpdate:s,onRemove:a,enableSizing:m,enablePositioning:x}){let[u,h]=(0,l.useState)(!1),p=e=>{s({position:e})},g=e=>{s({sizing:e})},b=(e,a)=>{s({sizing:"custom",customWidth:e,customHeight:a})};return(0,t.jsx)(r.Zp,{className:"relative group",children:(0,t.jsxs)(r.Wu,{className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{className:(0,i.cn)("relative overflow-hidden rounded-lg bg-gray-100","left"===e.position&&"ml-0 mr-auto","center"===e.position&&"mx-auto","right"===e.position&&"ml-auto mr-0","full"===e.position&&"w-full"),children:[(0,t.jsx)("img",{src:e.url,alt:e.alt||e.name,className:(0,i.cn)("object-cover","small"===e.sizing&&"w-32 h-32","medium"===e.sizing&&"w-48 h-48","large"===e.sizing&&"w-64 h-64","custom"===e.sizing&&e.customWidth&&e.customHeight&&`w-[${e.customWidth}px] h-[${e.customHeight}px]`,!e.sizing&&"w-48 h-48"),style:"custom"===e.sizing&&(e.customWidth||e.customHeight)?{width:e.customWidth?`${e.customWidth}px`:"auto",height:e.customHeight?`${e.customHeight}px`:"auto"}:void 0}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-200 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex space-x-2",children:[(0,t.jsx)(n.$,{variant:"secondary",size:"sm",onClick:()=>h(!u),children:(0,t.jsx)(ec.A,{className:"h-4 w-4"})}),(0,t.jsx)(n.$,{variant:"destructive",size:"sm",onClick:a,children:(0,t.jsx)(F.A,{className:"h-4 w-4"})})]})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium truncate",children:e.name}),(0,t.jsx)(d.E,{variant:"outline",className:"text-xs",children:em(e.size)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600",children:"Alt Text"}),(0,t.jsx)(c.p,{value:e.alt||"",onChange:e=>s({alt:e.target.value}),placeholder:"Describe this image...",className:"text-xs h-8"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600",children:"Caption (optional)"}),(0,t.jsx)(c.p,{value:e.caption||"",onChange:e=>s({caption:e.target.value}),placeholder:"Image caption...",className:"text-xs h-8"})]})]}),u&&(0,t.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[x&&(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600 mb-2 block",children:"Position"}),(0,t.jsx)("div",{className:"flex space-x-1",children:[{value:"left",label:"Left",icon:el.A},{value:"center",label:"Center",icon:ei.A},{value:"right",label:"Right",icon:er.A},{value:"full",label:"Full Width",icon:en.A}].map(({value:s,label:a,icon:l})=>(0,t.jsx)(n.$,{variant:e.position===s?"default":"outline",size:"sm",onClick:()=>p(s),className:"h-8 px-2",title:a,children:(0,t.jsx)(l,{className:"h-3 w-3"})},s))})]}),m&&(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600 mb-2 block",children:"Size"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex space-x-1",children:[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"},{value:"custom",label:"Custom"}].map(({value:s,label:a})=>(0,t.jsx)(n.$,{variant:e.sizing===s?"default":"outline",size:"sm",onClick:()=>g(s),className:"h-8 px-3 text-xs",children:a},s))}),"custom"===e.sizing&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-500",children:"Width (px)"}),(0,t.jsx)(c.p,{type:"number",value:e.customWidth||"",onChange:s=>b(parseInt(s.target.value)||void 0,e.customHeight),placeholder:"Auto",className:"text-xs h-8"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-500",children:"Height (px)"}),(0,t.jsx)(c.p,{type:"number",value:e.customHeight||"",onChange:s=>b(e.customWidth,parseInt(s.target.value)||void 0),placeholder:"Auto",className:"text-xs h-8"})]})]})]})]})]})]})})}function eh({value:e,onChange:s,className:a,maxSizeKB:d=5e3,acceptedFormats:m=["image/jpeg","image/png","image/gif","image/webp"],showPreview:x=!0,enableSizing:u=!0,enablePositioning:h=!0,enableMediaLibrary:p=!1,placeholder:g="Upload an image or drag and drop"}){let[b,j]=(0,l.useState)(!1),[v,f]=(0,l.useState)(!1),[N,w]=(0,l.useState)(null),y=(0,l.useRef)(null),C=e=>m.includes(e.type)?e.size>1024*d?`File too large. Maximum size: ${em(1024*d)}`:null:`Invalid file format. Accepted formats: ${m.map(e=>e.split("/")[1]).join(", ")}`,k=(0,l.useCallback)(async e=>{f(!0),w(null);try{let a=C(e);if(a)return void w(a);let t=URL.createObjectURL(e),l=new Image;l.onload=()=>{let a={id:ex(),url:t,name:e.name,size:e.size,type:e.type,width:l.width,height:l.height,position:"center",sizing:"medium"};s(a),URL.revokeObjectURL(t)},l.src=t}catch(e){w(e instanceof Error?e.message:"Upload failed")}finally{f(!1)}},[s,d,m]),A=(0,l.useCallback)(e=>{let s=e.target.files?.[0];s&&k(s)},[k]),V=(0,l.useCallback)(e=>{e.preventDefault(),j(!0)},[]),S=(0,l.useCallback)(e=>{e.preventDefault(),j(!1)},[]),z=(0,l.useCallback)(e=>{e.preventDefault(),j(!1);let s=e.dataTransfer.files[0];s&&k(s)},[k]),$=(0,l.useCallback)(()=>{e?.url&&URL.revokeObjectURL(e.url),s(null)},[e,s]),R=(0,l.useCallback)(a=>{e&&s({...e,...a})},[e,s]);return e&&x?(0,t.jsx)("div",{className:a,children:(0,t.jsx)(eu,{image:e,onUpdate:R,onRemove:$,enableSizing:u,enablePositioning:h})}):(0,t.jsxs)("div",{className:(0,i.cn)("space-y-3",a),children:[(0,t.jsx)(r.Zp,{className:(0,i.cn)("border-2 border-dashed transition-colors cursor-pointer",b?"border-blue-500 bg-blue-50":"border-gray-300",v&&"opacity-50 cursor-not-allowed"),onDragOver:V,onDragLeave:S,onDrop:z,onClick:()=>!v&&y.current?.click(),children:(0,t.jsxs)(r.Wu,{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:v?(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-600"}):(0,t.jsx)(eo.A,{className:"h-6 w-6 text-gray-600"})}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:v?"Uploading...":g}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[m.map(e=>e.split("/")[1]).join(", ")," up to ",em(1024*d)]})]}),!v&&(0,t.jsxs)("div",{className:"flex space-x-2 mt-4",children:[(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(T.A,{className:"h-4 w-4 mr-2"}),"Choose File"]}),p&&(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(ed.A,{className:"h-4 w-4 mr-2"}),"Media Library"]})]})]})}),(0,t.jsx)("input",{ref:y,type:"file",accept:m.join(","),onChange:A,className:"hidden"}),N&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 text-red-600"}),(0,t.jsx)("span",{className:"text-sm text-red-800",children:N})]})}),(0,t.jsx)(r.Zp,{className:"border-dashed",children:(0,t.jsxs)(r.Wu,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(B.A,{className:"h-4 w-4 text-gray-500"}),(0,t.jsx)(o.J,{className:"text-sm text-gray-600",children:"Or add image URL:"})]}),(0,t.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,t.jsx)(c.p,{placeholder:"https://example.com/image.jpg",className:"text-sm",onKeyDown:e=>{if("Enter"===e.key&&e.currentTarget.value){let a=e.currentTarget.value;s({id:ex(),url:a,name:a.split("/").pop()||"Image",size:0,type:"image/jpeg",position:"center",sizing:"medium"}),e.currentTarget.value=""}}}),(0,t.jsx)(n.$,{variant:"outline",size:"sm",onClick:e=>{let a=e.currentTarget.previousElementSibling;if(a?.value){let e=a.value;s({id:ex(),url:e,name:e.split("/").pop()||"Image",size:0,type:"image/jpeg",position:"center",sizing:"medium"}),a.value=""}},children:"Add"})]})]})})]})}let ep=e=>{let s=[],a=0;return s.push({id:`block_${Date.now()}`,type:"text",content:e,order:a++}),s};function eg({content:e,onChange:s,className:a,placeholder:r="Click to edit content...",enableRichText:c=!0,enableImages:o=!0,enableVariables:m=!0,variableContext:x,autoSave:u=!1,autoSaveDelay:h=1e3,maxLength:g,showWordCount:b=!1,allowFullscreen:j=!0}){let[v,f]=(0,l.useState)({type:"view",fullscreen:!1}),[N,w]=(0,l.useState)(e),[y,C]=(0,l.useState)(!1),[k,A]=(0,l.useState)(null),V=(0,l.useMemo)(()=>ep(N),[N]),S=(0,l.useCallback)(a=>{if(w(a),C(a!==e),u){let e=setTimeout(()=>{s(a),C(!1)},h);return()=>clearTimeout(e)}},[e,s,u,h]),z=(0,l.useCallback)(()=>{s(N),C(!1),f(e=>({...e,type:"view"}))},[N,s]),$=(0,l.useCallback)(()=>{w(e),C(!1),f(e=>({...e,type:"view"}))},[e]),R=(0,l.useCallback)(e=>{Date.now(),Math.random().toString(36).substring(2,15),V.length,"text"===e?S(N+"\n\n\x3c!-- New text block --\x3e"):S(N+"\n\n\x3c!-- Image placeholder --\x3e")},[V.length,N,S]),U=(0,l.useCallback)(e=>{f(s=>({...s,type:e}))},[]),_=(0,l.useCallback)(()=>{f(e=>({...e,fullscreen:!e.fullscreen}))},[]),D=(0,l.useMemo)(()=>N.trim().split(/\s+/).filter(e=>e.length>0).length,[N]),Z=()=>(0,t.jsxs)("div",{className:(0,i.cn)("group relative min-h-[120px] p-4 border border-transparent rounded-lg cursor-pointer transition-all hover:border-gray-200 hover:bg-gray-50",!e&&"text-gray-500 italic"),onClick:()=>U("edit"),children:[e?(0,t.jsx)("div",{className:"prose prose-sm max-w-none",children:m&&x?(0,t.jsx)(I,{content:e,context:x,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:!1,onInterpolationResult:A}):(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:e}})}):(0,t.jsx)("span",{children:r}),(0,t.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,t.jsx)(n.$,{variant:"ghost",size:"sm",children:(0,t.jsx)(E.A,{className:"h-4 w-4"})})})]}),J=()=>(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(et,{content:N,onChange:S,variableContext:x,enablePreview:!1,enableVariables:m,enableFormatting:c,enableConditionals:m,placeholder:r,maxHeight:v.fullscreen?"70vh":"400px"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex space-x-2",children:[o&&(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>R("image"),children:[(0,t.jsx)(T.A,{className:"h-4 w-4 mr-1"}),"Add Image"]}),(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>U("preview"),children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Preview"]}),j&&(0,t.jsx)(n.$,{variant:"outline",size:"sm",onClick:_,children:v.fullscreen?(0,t.jsx)(M.A,{className:"h-4 w-4"}):(0,t.jsx)(P.A,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:$,children:[(0,t.jsx)(F.A,{className:"h-4 w-4 mr-1"}),"Cancel"]}),(0,t.jsxs)(n.$,{size:"sm",onClick:z,disabled:!y,children:[(0,t.jsx)(W.A,{className:"h-4 w-4 mr-1"}),"Save"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 pt-2 border-t",children:[(0,t.jsxs)("div",{className:"flex space-x-4",children:[b&&(0,t.jsxs)("span",{children:[D," words",g&&` / ${g} max`]}),k&&(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs",children:[k.processedVariables.length," variables"]}),k.missingVariables.length>0&&(0,t.jsxs)(d.E,{variant:"destructive",className:"text-xs",children:[k.missingVariables.length," missing"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[y&&(0,t.jsx)(d.E,{variant:"outline",className:"text-xs",children:"Unsaved changes"}),u&&!y&&(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(L.A,{className:"h-3 w-3 text-green-600"}),(0,t.jsx)("span",{className:"text-green-600",children:"Auto-saved"})]})]})]})]}),H=()=>(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"prose prose-sm max-w-none border rounded-lg p-4 bg-gray-50",children:m&&x?(0,t.jsx)(I,{content:N,context:x,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:!0,showDebugInfo:!0}):(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:N}})}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>U("edit"),children:[(0,t.jsx)(E.A,{className:"h-4 w-4 mr-1"}),"Edit"]}),(0,t.jsxs)(n.$,{size:"sm",onClick:z,disabled:!y,children:[(0,t.jsx)(W.A,{className:"h-4 w-4 mr-1"}),"Save Preview"]})]})]}),B=()=>{switch(v.type){case"edit":return J();case"preview":return H();default:return Z()}};return v.fullscreen?(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-white",children:(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsx)("div",{className:"flex-shrink-0 p-4 border-b bg-gray-50",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Content Editor"}),(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:_,children:[(0,t.jsx)(M.A,{className:"h-4 w-4 mr-1"}),"Exit Fullscreen"]})]})}),(0,t.jsx)("div",{className:"flex-1 overflow-auto p-4",children:(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:B()})})]})}):(0,t.jsx)("div",{className:(0,i.cn)("space-y-2",a),children:B()})}var eb=a(34318),ej=a(97638),ev=a(17581),ef=a(13943);let eN={desktop:{name:"Desktop",icon:eb.A,width:1200,height:800,maxWidth:"100%",description:"Full desktop experience"},tablet:{name:"Tablet",icon:ej.A,width:768,height:1024,maxWidth:"768px",description:"iPad and tablet devices"},mobile:{name:"Mobile",icon:ev.A,width:375,height:667,maxWidth:"375px",description:"iPhone and mobile devices"}};function ew({device:e,orientation:s,children:a,showFrame:r=!0}){let n=eN[e],c=(0,l.useMemo)(()=>{if(!r||"desktop"===e)return{width:"100%",maxWidth:n.maxWidth,minHeight:"desktop"===e?"600px":"400px"};let a="landscape"===s,t=a?Math.max(n.width,n.height):n.width,l=a?Math.min(n.width,n.height):n.height;return{width:`${t}px`,height:`${l}px`,maxWidth:"100%"}},[e,s,n,r]);return r&&"desktop"!==e?(0,t.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:(0,i.cn)("relative bg-gray-900 rounded-[2rem] p-2 shadow-2xl","mobile"===e&&"rounded-[2.5rem]","tablet"===e&&"rounded-[1.5rem]"),style:c,children:[(0,t.jsxs)("div",{className:(0,i.cn)("bg-white rounded-[1.5rem] w-full h-full overflow-hidden relative","mobile"===e&&"rounded-[2rem]","tablet"===e&&"rounded-[1rem]"),children:["mobile"===e&&(0,t.jsxs)("div",{className:"h-6 bg-gray-50 flex items-center justify-between px-4 text-xs",children:[(0,t.jsx)("span",{className:"font-medium",children:"9:41"}),(0,t.jsxs)("div",{className:"flex space-x-1",children:[(0,t.jsx)("div",{className:"w-4 h-2 bg-gray-300 rounded-sm"}),(0,t.jsx)("div",{className:"w-6 h-2 bg-green-500 rounded-sm"})]})]}),(0,t.jsx)("div",{className:(0,i.cn)("w-full overflow-auto","mobile"===e?"h-[calc(100%-1.5rem)]":"h-full"),children:a})]}),"mobile"===e&&(0,t.jsx)("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 w-12 h-1 bg-gray-600 rounded-full"})]})}):(0,t.jsx)("div",{className:"w-full",style:c,children:a})}function ey({children:e,className:s,enableDeviceToggle:a=!0,enableOrientationToggle:c=!0,showDeviceFrame:o=!0,defaultDevice:m="desktop",onDeviceChange:x}){let[u,h]=(0,l.useState)(m),[g,b]=(0,l.useState)("portrait"),[j,v]=(0,l.useState)(!1),f=e=>{h(e),x?.(e),"desktop"===e&&b("portrait")},N=()=>{"desktop"!==u&&b(e=>"portrait"===e?"landscape":"portrait")},w=()=>{v(!j)},y=()=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 border-b",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(p.A,{className:"h-4 w-4 text-gray-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Preview"}),(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs",children:[eN[u].name,"desktop"!==u&&"landscape"===g&&" (Landscape)"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[a&&(0,t.jsx)("div",{className:"flex border rounded-lg overflow-hidden",children:Object.entries(eN).map(([e,s])=>{let a=s.icon;return(0,t.jsx)(n.$,{variant:u===e?"default":"ghost",size:"sm",onClick:()=>f(e),className:"h-8 px-3 rounded-none border-0",title:s.description,children:(0,t.jsx)(a,{className:"h-3 w-3"})},e)})}),c&&"desktop"!==u&&(0,t.jsx)(n.$,{variant:"outline",size:"sm",onClick:N,className:"h-8 px-2",title:`Switch to ${"portrait"===g?"landscape":"portrait"}`,children:(0,t.jsx)(ef.A,{className:"h-3 w-3"})}),(0,t.jsx)(n.$,{variant:"outline",size:"sm",onClick:w,className:"h-8 px-2",title:j?"Exit fullscreen":"Enter fullscreen",children:j?(0,t.jsx)(M.A,{className:"h-3 w-3"}):(0,t.jsx)(P.A,{className:"h-3 w-3"})})]})]});return j?(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-white",children:(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[y(),(0,t.jsx)("div",{className:"flex-1 overflow-auto bg-gray-100",children:(0,t.jsx)(ew,{device:u,orientation:g,showFrame:o,children:e})})]})}):(0,t.jsxs)(r.Zp,{className:(0,i.cn)("overflow-hidden",s),children:[y(),(0,t.jsx)(r.Wu,{className:"p-0 bg-gray-100",children:(0,t.jsx)(ew,{device:u,orientation:g,showFrame:o,children:e})})]})}function eC({section:e,isPreview:s=!1,onUpdate:a,className:j}){let v=e.settings,[f,w]=(0,l.useState)(!1),[y,C]=(0,l.useState)(!1),k=function(e,s,a={}){let[t,i]=(0,l.useState)({availableVariables:[],variableMap:new Map,isLoading:!0,error:void 0}),r=(0,l.useMemo)(()=>({getVariable:e=>t.variableMap.get(e.startsWith("@")?e:`@${e}`),hasVariable:e=>t.variableMap.has(e.startsWith("@")?e:`@${e}`),getVariableSuggestions:e=>{if(!e||e.length<1)return t.availableVariables.map(e=>({variable:e,matchScore:1,displayText:`@${e.name}`}));let s=e.toLowerCase().replace(/^@/,"");return t.availableVariables.map(e=>{let a=e.name.toLowerCase(),t=e.displayName.toLowerCase(),l=0;return a===s?l=100:a.startsWith(s)?l=80:t.startsWith(s)?l=60:a.includes(s)?l=40:t.includes(s)&&(l=20),{variable:e,matchScore:l,displayText:`@${e.name}`}}).filter(e=>e.matchScore>0).sort((e,s)=>s.matchScore-e.matchScore)},replaceVariableMentions:(e,s,a="{{VARIABLE}}")=>e.replace(/@(\w+)/g,(e,l)=>{let i=t.variableMap.get(`@${l}`);return i?s?.get(l)||i.previewValue||a.replace("{{VARIABLE}}",l):e}),extractVariableMentions:e=>(e.match(/@(\w+)/g)||[]).map(e=>e.substring(1)).filter((e,s,a)=>a.indexOf(e)===s).filter(e=>t.variableMap.has(`@${e}`)),validateVariableMentions:e=>{let s=e.match(/@(\w+)/g)||[],a=[];for(let e of s){let s=e.substring(1);t.variableMap.has(`@${s}`)||a.includes(s)||a.push(s)}return{isValid:0===a.length,invalidVariables:a}},getVariablesBySection:()=>{let e={};return t.availableVariables.forEach(s=>{let a=s.sectionTitle||"Untitled Section";e[a]||(e[a]=[]),e[a].push(s)}),e}}),[t.availableVariables,t.variableMap]);return{...t,...r}}(0,0).availableVariables||[],A=(0,l.useMemo)(()=>{let e={};return k.forEach(s=>{"text"===s.type?e[s.name]=`Sample ${s.name}`:"number"===s.type?e[s.name]=42:"boolean"===s.type?e[s.name]=!0:"array"===s.type?e[s.name]=["Option 1","Option 2"]:"object"===s.type?e[s.name]={sample:"data"}:e[s.name]=`Sample ${s.name}`}),e.name="John Doe",e.email="john@example.com",e.score=85,e.recommendation="You are doing great! Keep up the excellent work.",e},[k]),V=(0,l.useMemo)(()=>({variables:A,availableVariables:k,formatters:{},conditionalRules:v.conditionalContent||[]}),[A,k,v.conditionalContent]);(0,b.v)(v.title||"Your Results",{onSave:async e=>{await a({settings:{...v,title:e}})}});let S=async e=>{await a({settings:{...v,content:e}})},z=async e=>{await a({settings:{...v,headerImage:e,enableVariableInterpolation:!1!==v.enableVariableInterpolation}})},$=async e=>{await a({settings:{...v,enableVariableInterpolation:e}})};return s?(0,t.jsx)(N,{className:j,children:(0,t.jsx)("div",{className:"py-8",children:(()=>{let a=!1!==v.enableVariableInterpolation;switch(e.type){case"output-results":return(0,t.jsxs)(r.Zp,{className:"w-full max-w-2xl mx-auto",children:[v.headerImage&&(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("img",{src:v.headerImage.url,alt:v.headerImage.alt||"Header image",className:(0,i.cn)("w-full object-cover rounded-t-lg","small"===v.headerImage.sizing&&"h-32","medium"===v.headerImage.sizing&&"h-48","large"===v.headerImage.sizing&&"h-64",!v.headerImage.sizing&&"h-48")}),v.headerImage.caption&&(0,t.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-2",children:v.headerImage.caption})]}),(0,t.jsx)(r.aR,{className:"text-center",children:(0,t.jsx)(r.ZB,{className:"text-2xl font-bold",children:a?(0,t.jsx)(I,{content:v.title,context:V,showPreview:!0,enableRealTimeProcessing:!0}):v.title})}),(0,t.jsxs)(r.Wu,{className:"space-y-4",children:[(0,t.jsx)("div",{className:"prose prose-sm max-w-none",children:a?(0,t.jsx)(I,{content:v.content,context:V,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:s}):(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:v.content}})}),v.showScore&&(0,t.jsx)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-blue-600",children:a?(0,t.jsx)(I,{content:"Score: @score/100",context:V,showPreview:!0,enableRealTimeProcessing:!0}):"Score: 85/100"})})]})]});case"output-download":return(0,t.jsxs)(r.Zp,{className:"w-full max-w-md mx-auto",children:[(0,t.jsx)(r.aR,{className:"text-center",children:(0,t.jsx)(r.ZB,{className:"text-xl font-bold",children:a?(0,t.jsx)(I,{content:v.title,context:V,showPreview:!0,enableRealTimeProcessing:!0}):v.title})}),(0,t.jsxs)(r.Wu,{className:"text-center space-y-4",children:[(0,t.jsx)("div",{className:"text-gray-600",children:a?(0,t.jsx)(I,{content:v.content,context:V,showPreview:!0,enableRealTimeProcessing:!0}):v.content}),(0,t.jsxs)(n.$,{className:"w-full",onClick:()=>{v.fileUrl&&window.open(v.fileUrl,"_blank")},disabled:!v.fileUrl,children:[(0,t.jsx)(x.A,{className:"h-4 w-4 mr-2"}),a?(0,t.jsx)(I,{content:v.fileName||"Download @name Report",context:V,showPreview:!0,enableRealTimeProcessing:!0}):v.fileName||"Download Resource"]})]})]});case"output-redirect":return(0,t.jsx)(r.Zp,{className:"w-full max-w-md mx-auto",children:(0,t.jsxs)(r.Wu,{className:"text-center space-y-4 pt-6",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(u.A,{className:"h-6 w-6 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:a?(0,t.jsx)(I,{content:v.message||"Redirecting @name...",context:V,showPreview:!0,enableRealTimeProcessing:!0}):v.message||"Redirecting..."}),(0,t.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["You will be redirected in ",v.delay||0," seconds"]})]})]})});default:return(0,t.jsx)(r.Zp,{className:"w-full max-w-md mx-auto",children:(0,t.jsxs)(r.Wu,{className:"text-center space-y-4 pt-6",children:[(0,t.jsx)("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(h.A,{className:"h-6 w-6 text-gray-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:a?(0,t.jsx)(I,{content:v.title,context:V,showPreview:!0,enableRealTimeProcessing:!0}):v.title}),(0,t.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:a?(0,t.jsx)(I,{content:v.content,context:V,showPreview:!0,enableRealTimeProcessing:!0}):v.content})]})]})})}})()})}):(0,t.jsxs)("div",{className:(0,i.cn)("space-y-6",j),children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(h.A,{className:"h-5 w-5 text-emerald-600"}),(0,t.jsx)(d.E,{variant:"outline",className:"bg-emerald-50 text-emerald-700 border-emerald-200",children:"output-results"===e.type?"Results Page":"output-download"===e.type?"Download Link":"output-redirect"===e.type?"Redirect":"Output"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Title"}),(0,t.jsx)(eg,{content:v.title||"Your Results",onChange:async e=>{await a({settings:{...v,title:e}})},placeholder:"Enter section title...",enableRichText:!1,enableImages:!1,enableVariables:!1!==v.enableVariableInterpolation,variableContext:V,className:"mt-1"}),v.enableVariableInterpolation&&(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Use @variableName to insert dynamic content. Examples: @name, @score, @recommendation"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Content"}),(0,t.jsx)(eg,{content:v.content||"Based on your answers...",onChange:S,placeholder:"Enter section content...",enableRichText:!0,enableImages:!0,enableVariables:!1!==v.enableVariableInterpolation,variableContext:V,showWordCount:!0,allowFullscreen:!0,className:"mt-1"}),v.enableVariableInterpolation&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Supports variable interpolation, conditional content, and formatting. Use `","{","if @variable","}","content","{/if}","` for conditions."]})]}),"output-results"===e.type&&(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Header Image (optional)"}),(0,t.jsx)(eh,{value:v.headerImage||null,onChange:z,placeholder:"Add a header image to your results page",enableSizing:!0,enablePositioning:!1,className:"mt-1"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Variable Interpolation"}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(m.d,{checked:!1!==v.enableVariableInterpolation,onCheckedChange:$,id:"enable-interpolation"}),(0,t.jsx)(o.J,{htmlFor:"enable-interpolation",className:"text-sm text-gray-600",children:"Enable dynamic content with variables"})]}),!1!==v.enableVariableInterpolation&&(0,t.jsxs)("div",{className:"space-y-3 pl-6 border-l-2 border-emerald-200",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>C(!y),children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-1"}),y?"Edit Mode":"Preview Mode"]}),(0,t.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>w(!f),children:[(0,t.jsx)(g.A,{className:"h-4 w-4 mr-1"}),"Debug Info"]})]}),k.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-600 mb-2",children:"Available Variables:"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[k.slice(0,10).map((e,s)=>(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:["@",e.name]},s)),k.length>10&&(0,t.jsxs)(d.E,{variant:"outline",className:"text-xs text-gray-500",children:["+",k.length-10," more"]})]})]})]})]}),"output-download"===e.type&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Download Settings"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600",children:"File URL"}),(0,t.jsx)(c.p,{value:v.fileUrl||"",onChange:e=>a({settings:{...v,fileUrl:e.target.value}}),placeholder:"https://example.com/file.pdf"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600",children:"File Name"}),(0,t.jsx)(c.p,{value:v.fileName||"",onChange:e=>a({settings:{...v,fileName:e.target.value}}),placeholder:"resource.pdf"})]})]})]}),"output-redirect"===e.type&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Redirect Settings"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600",children:"Redirect URL"}),(0,t.jsx)(c.p,{value:v.url||"",onChange:e=>a({settings:{...v,url:e.target.value}}),placeholder:"https://example.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.J,{className:"text-xs text-gray-600",children:"Delay (seconds)"}),(0,t.jsx)(c.p,{type:"number",value:v.delay||0,onChange:e=>a({settings:{...v,delay:parseInt(e.target.value)||0}}),placeholder:"0"})]})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t",children:[(0,t.jsx)(o.J,{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Responsive Preview"}),(0,t.jsx)(ey,{enableDeviceToggle:!0,enableOrientationToggle:!0,showDeviceFrame:!0,defaultDevice:"desktop",className:"scale-90 origin-top-left",children:(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(eC,{section:e,isPreview:!0,onUpdate:a})})})]})]})}},85167:(e,s,a)=>{a.d(s,{i$:()=>i,iB:()=>r}),a(60687);var t=a(43210);let l=(0,t.createContext)(void 0);function i(){let e=(0,t.useContext)(l);if(!e)throw Error("useCapture must be used within a CaptureProvider");return e}function r(){let{captureState:e,isCaptureRequired:s}=i();return{isResultsLocked:s&&!e.isCompleted,canAccessResults:!s||e.isCompleted,captureCompleted:e.isCompleted,leadId:e.leadId}}}};
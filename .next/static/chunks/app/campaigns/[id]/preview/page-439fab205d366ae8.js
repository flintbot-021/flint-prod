(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[507],{7435:(e,s,t)=>{Promise.resolve().then(t.bind(t,73402))},73402:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>O});var a=t(95155),i=t(11518),r=t.n(i),n=t(12115),l=t(35695),c=t(17712),o=t(53999),d=t(97168),m=t(88145),u=t(16785),x=t(81497),g=t(49376),p=t(57434),h=t(51154),b=t(71539),y=t(75021),j=t(381),f=t(42355),N=t(92657),v=t(13052),w=t(85339),A=t(85690),S=t(62132);let I=async(e,s)=>{let t=2e3*Math.random()+1e3;await new Promise(e=>setTimeout(e,t));let a=P(s);return{recommendation:a,score:Math.floor(40*Math.random())+60,insights:C(s),processingTime:Math.round(t),prompt:e,interpolatedPrompt:D(e,s)}},P=e=>{let s=e.name||"User",t=e.goal||"growth",a={growth:"".concat(s,", based on your focus on business growth, I recommend implementing a customer acquisition strategy that leverages digital marketing channels. Focus on building strong brand awareness and customer loyalty programs."),efficiency:"".concat(s,", since you're prioritizing efficiency, consider automating your core business processes and implementing lean methodologies. This will help reduce operational overhead while maintaining quality."),innovation:"".concat(s,", with your interest in innovation, I suggest investing in emerging technologies that align with your industry. Consider establishing partnerships with tech companies and fostering a culture of continuous learning.")};return a[t]||a.growth},C=e=>{let s=[];return e.name&&s.push("User engagement level: High (provided personal information)"),e.email&&s.push("Email domain analysis: ".concat(e.email.includes("@gmail.com")?"Personal":"Professional"," email")),e.goal&&s.push("Primary focus area: ".concat(e.goal," - this indicates a ").concat("growth"===e.goal?"scaling":"efficiency"===e.goal?"optimization":"transformation"," mindset")),s},D=(e,s)=>{let t=e;return Object.entries(s).forEach(e=>{let[s,a]=e;t=t.replace(RegExp("@".concat(s),"g"),String(a))}),t},T=(e,s,t,a)=>!!s.bypassDisplayRules||!!e.isVisible&&(e.settings,!("logic"===e.type&&!t.name&&!t.email||e.type.startsWith("output-")&&0===Object.keys(t).length));function E(e){let{section:s,sectionIndex:t,isActive:i,userInputs:r,aiOutputs:l,previewConfig:c,onSectionComplete:f,onUpdate:N}=e,[v,w]=(0,n.useState)(!1),[A,P]=(0,n.useState)(null),C=(e=>{switch(e){case"capture":default:return u.A;case"choice":return x.A;case"logic":return g.A;case"output-results":case"output-download":case"output-redirect":return p.A}})(s.type),D=(e=>{switch(e){case"capture":return"Capture";case"choice":return"Choice";case"logic":return"AI Logic";case"output-results":return"Results";case"output-download":return"Download";case"output-redirect":return"Redirect";default:return"Section"}})(s.type),T=async()=>{if("logic"===s.type){w(!0);try{let e=s.settings.prompt||"Analyze the user inputs and provide recommendations.",a=await I(e,r);P(a),f(t,{aiProcessing:!0,...a})}catch(e){console.error("AI Processing error:",e)}finally{w(!1)}}};return(0,a.jsxs)("div",{className:(0,o.cn)("min-h-screen transition-all duration-300",i?"opacity-100":"opacity-50 pointer-events-none"),children:[(0,a.jsx)("div",{className:"bg-white border-b py-4 px-6",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(C,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)(m.E,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:D}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["Section ",t+1]}),c.enableAITesting&&(0,a.jsxs)(m.E,{variant:"secondary",className:"bg-purple-100 text-purple-700",children:[(0,a.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"Testing"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.E,{variant:i?"default":"secondary",className:"text-xs",children:i?"Active":"Preview"}),c.showDebugInfo&&(0,a.jsxs)(m.E,{variant:"outline",className:"text-xs",children:[(0,a.jsx)(j.A,{className:"h-3 w-3 mr-1"}),"Debug"]})]})]})}),(0,a.jsx)("div",{className:"py-8 px-6 bg-gray-50 min-h-[calc(100vh-80px)]",children:(()=>{let e=s.settings||{};switch(s.type){case"capture":return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:e.title||"Capture Section"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:e.content||"This is a capture section for collecting user information."}),(0,a.jsx)("div",{className:"space-y-4",children:(e.fields||[{id:"name",type:"text",label:"Full Name",required:!0},{id:"email",type:"email",label:"Email Address",required:!0}]).map((e,s)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.label,e.required&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsx)("input",{type:e.type||"text",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter your ".concat(e.label.toLowerCase()),defaultValue:r[e.id]||"",onChange:s=>{c.enableAITesting&&f(t,{...r,[e.id]:s.target.value})}})]},e.id||s))}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(d.$,{onClick:()=>{let e=new FormData(document.querySelector("form")),s={};e.forEach((e,t)=>{s[t]=e}),f(t,s)},className:"bg-blue-600 hover:bg-blue-700",children:"Continue"})}),c.showDebugInfo&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded border-l-4 border-blue-500",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"Debug: Capture Section"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Collected: ",Object.keys(r).join(", ")||"None"]})]})]});case"choice":return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:e.title||"Make Your Choice"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:e.content||"Please select from the following options."}),(0,a.jsx)("div",{className:"space-y-3",children:(e.choices||[{id:"growth",text:"Business Growth",value:"growth"},{id:"efficiency",text:"Efficiency Improvement",value:"efficiency"},{id:"innovation",text:"Innovation & Technology",value:"innovation"}]).map((e,s)=>(0,a.jsx)("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 cursor-pointer transition-colors",onClick:()=>f(t,{choice:e.value,[e.id]:e.value}),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-4 h-4 border border-gray-300 rounded mr-3"}),(0,a.jsx)("span",{className:"text-gray-900",children:e.text})]})},e.id||s))}),c.showDebugInfo&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded border-l-4 border-green-500",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"Debug: Choice Section"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Available choices: ",(e.choices||[]).length]})]})]});case"logic":return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[(0,a.jsx)(g.A,{className:"h-16 w-16 text-blue-600 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:e.title||"AI Processing"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:e.content||"Our AI is analyzing your responses..."}),v?(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-6",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 animate-spin text-blue-600"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Processing..."})]}):A?(0,a.jsx)("div",{className:"space-y-4 mb-6",children:(0,a.jsxs)("div",{className:"p-4 bg-green-50 rounded-lg text-left",children:[(0,a.jsx)("h4",{className:"font-medium text-green-800 mb-2",children:"âœ… Processing Complete"}),(0,a.jsx)("p",{className:"text-sm text-green-700",children:A.recommendation}),(0,a.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-xs text-green-600",children:[(0,a.jsxs)("span",{children:["Score: ",A.score,"/100"]}),(0,a.jsxs)("span",{children:["Time: ",A.processingTime,"ms"]})]})]})}):(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(d.$,{onClick:T,className:"bg-blue-600 hover:bg-blue-700",disabled:0===Object.keys(r).length,children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-2"}),c.enableAITesting?"Test AI Processing":"Start Processing"]}),0===Object.keys(r).length&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Complete previous sections to enable AI processing"})]}),c.showDebugInfo&&(0,a.jsxs)("div",{className:"p-3 bg-gray-50 rounded border-l-4 border-purple-500 text-left",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"Debug: AI Logic Section"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 mt-1 space-y-1",children:[(0,a.jsxs)("p",{children:["Prompt: ",e.prompt||"No prompt defined"]}),(0,a.jsxs)("p",{children:["Available inputs: ",Object.keys(r).join(", ")||"None"]}),A&&(0,a.jsxs)("details",{className:"mt-2",children:[(0,a.jsx)("summary",{className:"cursor-pointer font-medium",children:"Processing Results"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-auto",children:JSON.stringify(A,null,2)})]})]})]})]});case"output-results":case"output-download":case"output-redirect":return(0,a.jsxs)("div",{children:[(0,a.jsx)(S.x,{section:s,isPreview:!0,onUpdate:N,className:"max-w-4xl mx-auto"}),c.showDebugInfo&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded border-l-4 border-orange-500",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"Debug: Output Section"}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 mt-1 space-y-1",children:[(0,a.jsxs)("p",{children:["Type: ",s.type]}),(0,a.jsxs)("p",{children:["Available variables: ",Object.keys({...r,...l}).join(", ")||"None"]}),(0,a.jsxs)("details",{className:"mt-2",children:[(0,a.jsx)("summary",{className:"cursor-pointer font-medium",children:"Variable Context"}),(0,a.jsx)("pre",{className:"mt-1 text-xs bg-gray-100 p-2 rounded overflow-auto",children:JSON.stringify({...r,...l},null,2)})]})]})]})]});default:return(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(C,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:[D," Section"]}),(0,a.jsx)("p",{className:"text-gray-600",children:"This section type is not yet implemented in preview mode."}),c.showDebugInfo&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded border-l-4 border-gray-500 text-left max-w-md mx-auto",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-gray-700",children:"Debug: Unknown Section Type"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Type: ",s.type]})]})]})}})()})]})}function k(e){let{currentSection:s,totalSections:t,onPrevious:i,onNext:r,sections:n,completedSections:l,previewConfig:c,onConfigChange:m}=e;return(0,a.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-50",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:i,disabled:s<=0,children:[(0,a.jsx)(f.A,{className:"h-4 w-4 mr-1"}),"Previous"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("button",{onClick:()=>m({enableAITesting:!c.enableAITesting}),className:(0,o.cn)("text-xs px-2 py-1 rounded border transition-colors",c.enableAITesting?"bg-purple-100 text-purple-700 border-purple-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"),children:[(0,a.jsx)(y.A,{className:"h-3 w-3 mr-1 inline"}),"AI Testing"]}),(0,a.jsxs)("button",{onClick:()=>m({showDebugInfo:!c.showDebugInfo}),className:(0,o.cn)("text-xs px-2 py-1 rounded border transition-colors",c.showDebugInfo?"bg-gray-800 text-white border-gray-700":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"),children:[(0,a.jsx)(j.A,{className:"h-3 w-3 mr-1 inline"}),"Debug"]}),(0,a.jsxs)("button",{onClick:()=>m({bypassDisplayRules:!c.bypassDisplayRules}),className:(0,o.cn)("text-xs px-2 py-1 rounded border transition-colors",c.bypassDisplayRules?"bg-blue-100 text-blue-700 border-blue-200":"bg-gray-100 text-gray-600 border-gray-200 hover:bg-gray-200"),children:[(0,a.jsx)(N.A,{className:"h-3 w-3 mr-1 inline"}),"All Sections"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[s+1," of ",t]}),(0,a.jsx)("div",{className:"flex space-x-1",children:n.map((e,t)=>(0,a.jsx)("div",{className:(0,o.cn)("w-2 h-2 rounded-full transition-colors",t===s?"bg-blue-600":l.has(t)?"bg-green-500":"bg-gray-300")},t))})]})]}),(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:r,disabled:s>=t-1,children:["Next",(0,a.jsx)(v.A,{className:"h-4 w-4 ml-1"})]})]})})})}function O(e){let{}=e,s=(0,l.useParams)(),t=(0,l.useSearchParams)(),i=null==s?void 0:s.id,o=parseInt((null==t?void 0:t.get("section"))||"0"),x=(null==t?void 0:t.get("mode"))||"sequence";null==t||t.get("device");let g=(null==t?void 0:t.get("bypass"))==="true",[p,b]=(0,n.useState)(null),[f,N]=(0,n.useState)([]),[v,S]=(0,n.useState)(!0),[I,P]=(0,n.useState)(null),[C,D]=(0,n.useState)({currentSection:o,userInputs:{},aiOutputs:{},completedSections:new Set,testMode:"testing"===x,aiProcessingResults:{}}),[O,R]=(0,n.useState)({mode:x,bypassDisplayRules:g,enableAITesting:"testing"===x,simulateRealTiming:!1,showDebugInfo:!1});(0,n.useEffect)(()=>{i&&z()},[i]),(0,n.useEffect)(()=>{D(e=>({...e,currentSection:o}))},[o]);let z=async()=>{try{S(!0),P(null);let e=await (0,c.jz)(i);if(!e.success)throw Error(e.error||"Failed to load campaign");if(!e.data)throw Error("Campaign not found");b(e.data);let s=new Date().toISOString(),t=[{id:"1",type:"capture",title:"Welcome Survey",order:0,isVisible:!0,createdAt:s,updatedAt:s,settings:{title:"Welcome to Our Survey",content:"Please provide your information to get started.",fields:[{id:"name",type:"text",label:"Full Name",required:!0},{id:"email",type:"email",label:"Email Address",required:!0}]}},{id:"2",type:"choice",title:"Primary Goal Selection",order:1,isVisible:!0,createdAt:s,updatedAt:s,settings:{title:"What's your primary goal?",content:"Select the option that best describes your main objective.",choices:[{id:"growth",text:"Business Growth",value:"growth"},{id:"efficiency",text:"Efficiency Improvement",value:"efficiency"},{id:"innovation",text:"Innovation & Technology",value:"innovation"}],allowMultiple:!1}},{id:"3",type:"logic",title:"AI Processing",order:2,isVisible:!0,createdAt:s,updatedAt:s,settings:{title:"Processing Your Responses",content:"Our AI is analyzing your responses to provide personalized recommendations.",prompt:'Based on the user\'s name "@name", email "@email", and goal "@goal", provide a personalized recommendation.',outputDefinitions:[{id:"recommendation",name:"recommendation",type:"text",description:"Personalized recommendation based on user inputs"},{id:"score",name:"score",type:"number",description:"Compatibility score from 1-100"}]}},{id:"4",type:"output-results",title:"Results Page",order:3,isVisible:!0,createdAt:s,updatedAt:s,settings:{title:"Your Personalized Results",content:"Based on your responses, here are our recommendations:\n\n@recommendation\n\nYour compatibility score is @score out of 100.",enableVariableInterpolation:!0}}],a=t.filter(e=>T(e,O,C.userInputs,C.completedSections));N(O.bypassDisplayRules?t:a)}catch(e){console.error("Error loading campaign:",e),P(e instanceof Error?e.message:"An error occurred")}finally{S(!1)}},q=(e,s)=>{D(t=>{let a={...t,userInputs:{...t.userInputs,...s},completedSections:new Set([...t.completedSections,e])};return s.aiProcessing&&(a.aiOutputs={...t.aiOutputs,...s},a.aiProcessingResults={...t.aiProcessingResults,[e]:s}),a}),"sequence"===O.mode&&e<f.length-1&&setTimeout(()=>{V()},O.simulateRealTiming?1500:1e3)},M=async e=>{console.log("Section update in preview mode:",e)},V=()=>{D(e=>({...e,currentSection:Math.min(f.length-1,e.currentSection+1)}))};return v?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(h.A,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Loading Preview"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Preparing your campaign preview..."})]})}):I?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(w.A,{className:"h-8 w-8 text-red-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Preview Error"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:I}),(0,a.jsx)(d.$,{onClick:z,variant:"outline",children:"Try Again"})]})}):p&&0!==f.length?(0,a.jsxs)("div",{className:"jsx-75637827508fecf6 min-h-screen bg-gray-50",children:[(0,a.jsx)(r(),{id:"75637827508fecf6",children:"@media(max-width:768px){.mobile-optimized.jsx-75637827508fecf6{font-size:14px}}"}),(0,a.jsx)("div",{className:"jsx-75637827508fecf6 bg-blue-600 text-white text-center py-2 px-4",children:(0,a.jsxs)("div",{className:"jsx-75637827508fecf6 flex items-center justify-center space-x-2",children:[(0,a.jsx)(A.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"jsx-75637827508fecf6 text-sm font-medium",children:["Preview Mode - ",p.name]}),(0,a.jsxs)("div",{className:"jsx-75637827508fecf6 flex items-center space-x-2",children:[O.bypassDisplayRules&&(0,a.jsx)(m.E,{variant:"secondary",className:"bg-blue-500 text-white text-xs",children:"All Sections"}),O.enableAITesting&&(0,a.jsxs)(m.E,{variant:"secondary",className:"bg-purple-500 text-white text-xs",children:[(0,a.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"AI Testing"]}),O.showDebugInfo&&(0,a.jsxs)(m.E,{variant:"secondary",className:"bg-gray-500 text-white text-xs",children:[(0,a.jsx)(j.A,{className:"h-3 w-3 mr-1"}),"Debug"]})]})]})}),(0,a.jsxs)("div",{className:"jsx-75637827508fecf6 pb-20",children:[" ",f.map((e,s)=>(0,a.jsx)(E,{section:e,sectionIndex:s,isActive:s===C.currentSection,userInputs:C.userInputs,aiOutputs:C.aiOutputs,previewConfig:O,onSectionComplete:q,onUpdate:M},e.id))]}),(0,a.jsx)(k,{currentSection:C.currentSection,totalSections:f.length,onPrevious:()=>{D(e=>({...e,currentSection:Math.max(0,e.currentSection-1)}))},onNext:V,sections:f,completedSections:C.completedSections,previewConfig:O,onConfigChange:e=>{R(s=>{let t={...s,...e};return"bypassDisplayRules"in e&&setTimeout(()=>z(),100),t})}})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(u.A,{className:"h-8 w-8 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Content"}),(0,a.jsx)("p",{className:"text-gray-600",children:"This campaign doesn't have any sections to preview."})]})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[935,352,425,886,178,132,441,684,358],()=>s(7435)),_N_E=e.O()}]);
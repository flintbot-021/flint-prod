(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{3515:(e,s,a)=>{Promise.resolve().then(a.bind(a,30966))},30966:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>E});var l=a(95155),t=a(12115),r=a(35695),i=a(97168),c=a(88482),n=a(62533),d=a(76052),m=a(17712),o=a(54120),x=a(90242),h=a(12520),p=a(66932),j=a(84616),u=a(16785),g=a(17580),N=a(94870),f=a(33109),v=a(79397),y=a(40646),b=a(14186),w=a(72713),C=a(91788);let A=[{value:"today",label:"Today"},{value:"week",label:"This Week"},{value:"month",label:"This Month"},{value:"all",label:"All Time"}];function E(){let{user:e,loading:s,signOut:a}=(0,d.A)(),E=(0,r.useRouter)(),[_,k]=(0,t.useState)(null),[R,Z]=(0,t.useState)({totalCampaigns:0,totalLeads:0,completionRate:0,recentCampaigns:[]}),[P,S]=(0,t.useState)("month"),[T,B]=(0,t.useState)(!0),[F,W]=(0,t.useState)(null),[$,z]=(0,t.useState)([]),[D,L]=(0,t.useState)(!1);(0,t.useEffect)(()=>{s||e||E.push("/auth/login")},[e,s,E]),(0,t.useEffect)(()=>{e&&M()},[e,P]),(0,t.useEffect)(()=>{e&&_&&V()},[e,_,P]);let M=async()=>{try{var e;let s;B(!0),W(null);let[a,l]=await Promise.all([(0,m.Rk)(),(0,m.ME)({page:1,per_page:10})]);if(!a.success)throw Error(a.error||"Failed to load profile");if(!l.success)throw Error(l.error||"Failed to load campaigns");k(a.data||null);let t=(null==(e=l.data)?void 0:e.data)||[],r=0,i=0;await Promise.all(t.map(async e=>{let a=await (0,m.KT)(e.id);if(a.success&&a.data){let{total:l,completed:t,conversion_rate:c}=a.data;r+=l,i+=t;let n={...e,leadCount:l,completionRate:c};return(!s||l>s.leadCount)&&(s=n),n}return{...e,leadCount:0,completionRate:0}}));let c=r>0?i/r*100:0;Z({totalCampaigns:t.length,totalLeads:r,completionRate:Math.round(100*c)/100,recentCampaigns:t.slice(0,5),topPerformingCampaign:s})}catch(e){console.error("Error loading dashboard data:",e),W(e instanceof Error?e.message:"An error occurred")}finally{B(!1)}},V=async()=>{try{L(!0);let e=await (0,h.rA)(P,_);e.success&&e.data?z(e.data):(console.error("Failed to load export data:",e.error),z([]))}catch(e){console.error("Error loading export data:",e),z([])}finally{L(!1)}},Y=()=>{console.log("Export started...")};return s?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):e?(0,l.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,l.jsx)("header",{className:"bg-white shadow",children:(0,l.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,l.jsx)("div",{className:"flex items-center",children:(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"})}),(0,l.jsx)("div",{className:"flex items-center space-x-4",children:(0,l.jsx)(n.F,{variant:"compact"})})]})})}),(0,l.jsx)("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,l.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 space-y-4 sm:space-y-0",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(p.A,{className:"h-4 w-4 text-gray-500"}),(0,l.jsx)("select",{value:P,onChange:e=>S(e.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm",children:A.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]}),_&&(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,l.jsxs)("span",{className:"font-medium",children:[_.monthly_campaigns_used," / ",_.monthly_campaign_limit]}),(0,l.jsx)("span",{className:"ml-1",children:"campaigns used this month"})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)(o.NV,{data:$,source:"dashboard",title:"Export Dashboard Analytics",defaultFields:(0,h.gw)(),onExportStart:Y,onExportComplete:e=>{console.log("Export completed: ".concat(e))},onExportError:e=>{console.error("Export error:",e),W("Export failed: ".concat(e))},variant:"outline",size:"sm",disabled:D,showDropdown:!0}),(0,l.jsxs)(i.$,{onClick:()=>E.push("/dashboard/campaigns/create"),className:"flex items-center space-x-2",children:[(0,l.jsx)(j.A,{className:"h-4 w-4"}),(0,l.jsx)("span",{children:"New Campaign"})]})]})]}),F&&(0,l.jsx)(c.Zp,{className:"mb-6 border-red-200 bg-red-50",children:(0,l.jsx)(c.Wu,{className:"pt-6",children:(0,l.jsxs)("div",{className:"text-red-800",children:[(0,l.jsx)("p",{className:"font-medium",children:"Error loading dashboard data"}),(0,l.jsx)("p",{className:"text-sm mt-1",children:F}),(0,l.jsx)(i.$,{variant:"outline",size:"sm",className:"mt-2",onClick:M,children:"Try Again"})]})})}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(c.ZB,{className:"text-sm font-medium",children:"Total Campaigns"}),(0,l.jsx)(u.A,{className:"h-4 w-4 text-blue-600"})]}),(0,l.jsxs)(c.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:T?"...":R.totalCampaigns}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,l.jsxs)("span",{className:"text-green-600",children:["+",R.recentCampaigns.length]})," this period"]})]})]}),(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(c.ZB,{className:"text-sm font-medium",children:"Total Leads"}),(0,l.jsx)(g.A,{className:"h-4 w-4 text-green-600"})]}),(0,l.jsxs)(c.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:T?"...":R.totalLeads.toLocaleString()}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,l.jsxs)("span",{className:"text-green-600",children:[(0,l.jsx)(N.A,{className:"h-3 w-3 inline"}),"12%"]})," from last period"]})]})]}),(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(c.ZB,{className:"text-sm font-medium",children:"Completion Rate"}),(0,l.jsx)(f.A,{className:"h-4 w-4 text-purple-600"})]}),(0,l.jsxs)(c.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:T?"...":"".concat(R.completionRate.toFixed(1),"%")}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,l.jsxs)("span",{className:"text-green-600",children:[(0,l.jsx)(N.A,{className:"h-3 w-3 inline"}),"3.2%"]})," improvement"]})]})]}),(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(c.ZB,{className:"text-sm font-medium",children:"Monthly Usage"}),(0,l.jsx)(v.A,{className:"h-4 w-4 text-orange-600"})]}),(0,l.jsxs)(c.Wu,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold",children:T||!_?"...":"".concat(Math.round(_.monthly_campaigns_used/_.monthly_campaign_limit*100),"%")}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:_&&"".concat(_.monthly_campaigns_used," of ").concat(_.monthly_campaign_limit," campaigns")})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,l.jsx)("div",{className:"lg:col-span-2",children:(0,l.jsxs)(c.Zp,{children:[(0,l.jsx)(c.aR,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(c.ZB,{children:"Recent Campaigns"}),(0,l.jsx)(c.BT,{children:"Your latest lead magnet campaigns"})]}),(0,l.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>E.push("/dashboard/campaigns"),children:"View All"})]})}),(0,l.jsx)(c.Wu,{children:T?(0,l.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0].map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center space-x-4 p-3 border rounded-lg animate-pulse",children:[(0,l.jsx)("div",{className:"h-8 w-8 bg-gray-200 rounded"}),(0,l.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,l.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),(0,l.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},s))}):R.recentCampaigns.length>0?(0,l.jsx)("div",{className:"space-y-3",children:R.recentCampaigns.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>E.push("/dashboard/campaigns/".concat(e.id)),children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"flex-shrink-0",children:"published"===e.status?(0,l.jsx)(y.A,{className:"h-5 w-5 text-green-600"}):"draft"===e.status?(0,l.jsx)(b.A,{className:"h-5 w-5 text-yellow-600"}):(0,l.jsx)(v.A,{className:"h-5 w-5 text-gray-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-sm",children:e.name}),(0,l.jsxs)("p",{className:"text-xs text-gray-500 capitalize",children:[e.status," â€¢ ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,l.jsx)(N.A,{className:"h-4 w-4 text-gray-400"})]},e.id))}):(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)(u.A,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-gray-500 mb-4",children:"No campaigns yet"}),(0,l.jsx)(i.$,{onClick:()=>E.push("/dashboard/campaigns/create"),size:"sm",children:"Create Your First Campaign"})]})})]})}),(0,l.jsxs)("div",{className:"space-y-6",children:[R.topPerformingCampaign&&(0,l.jsxs)(c.Zp,{children:[(0,l.jsxs)(c.aR,{children:[(0,l.jsx)(c.ZB,{className:"text-lg",children:"Top Performer"}),(0,l.jsx)(c.BT,{children:"Your best converting campaign"})]}),(0,l.jsx)(c.Wu,{children:(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:R.topPerformingCampaign.name}),(0,l.jsx)("p",{className:"text-sm text-gray-500 capitalize",children:R.topPerformingCampaign.status})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-lg font-bold text-green-600",children:R.topPerformingCampaign.leadCount}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"Leads"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-lg font-bold text-purple-600",children:[R.topPerformingCampaign.completionRate.toFixed(1),"%"]}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:"Rate"})]})]}),(0,l.jsx)(i.$,{variant:"outline",size:"sm",className:"w-full",onClick:()=>{var e;return E.push("/dashboard/campaigns/".concat(null==(e=R.topPerformingCampaign)?void 0:e.id))},children:"View Details"})]})})]}),(0,l.jsxs)(c.Zp,{children:[(0,l.jsx)(c.aR,{children:(0,l.jsx)(c.ZB,{className:"text-lg",children:"Quick Actions"})}),(0,l.jsxs)(c.Wu,{className:"space-y-3",children:[(0,l.jsxs)(i.$,{variant:"outline",className:"w-full justify-start",onClick:()=>E.push("/dashboard/campaigns"),children:[(0,l.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"View All Campaigns"]}),(0,l.jsxs)(i.$,{variant:"outline",className:"w-full justify-start",onClick:()=>E.push("/dashboard/campaigns/create"),children:[(0,l.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Create New Campaign"]}),(0,l.jsxs)(i.$,{variant:"outline",className:"w-full justify-start",onClick:()=>{Y()},disabled:D||0===$.length,children:[(0,l.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Export Analytics"]})]})]}),(0,l.jsx)(n.F,{variant:"full"}),(0,l.jsx)(x.H,{source:"dashboard",maxEntries:5,showStats:!1,compact:!0})]})]})]})})]}):null}}},e=>{var s=s=>e(e.s=s);e.O(0,[524,935,352,590,963,710,246,178,533,652,441,684,358],()=>s(3515)),_N_E=e.O()}]);
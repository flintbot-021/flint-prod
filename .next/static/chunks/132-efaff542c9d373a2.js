"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[132],{62132:(e,s,t)=>{t.d(s,{x:()=>ek});var a=t(95155),l=t(12115),i=t(53999),n=t(88482),r=t(97168),c=t(89852),o=t(82714),d=t(88145),m=t(90088),x=t(91788),u=t(33786),h=t(16785),p=t(92657),g=t(29621),b=t(92220),v=t(88633),j=t(40646),f=t(32919);function N(e){let{children:s,className:t,lockedTitle:l="Results Locked",lockedMessage:r="Complete the form above to unlock your personalized results.",showProgress:c=!0}=e,{isResultsLocked:o,canAccessResults:d,captureCompleted:m}=(0,v.iB)();return d?(0,a.jsx)(a.Fragment,{children:s}):(0,a.jsxs)("div",{className:(0,i.cn)("relative",t),children:[(0,a.jsx)("div",{className:"filter blur-sm pointer-events-none select-none opacity-30",children:s}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)(n.Zp,{className:"w-full max-w-md mx-auto bg-white/95 backdrop-blur-sm border-2 border-gray-200 shadow-lg",children:[(0,a.jsxs)(n.aR,{className:"text-center space-y-3",children:[(0,a.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:m?(0,a.jsx)(j.A,{className:"h-8 w-8 text-green-600"}):(0,a.jsx)(f.A,{className:"h-8 w-8 text-gray-600"})}),(0,a.jsx)(n.ZB,{className:"text-xl font-bold text-gray-900",children:l})]}),(0,a.jsxs)(n.Wu,{className:"text-center space-y-4",children:[(0,a.jsx)("p",{className:"text-gray-600",children:r}),c&&(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 text-sm text-gray-500",children:[(0,a.jsx)("div",{className:(0,i.cn)("w-3 h-3 rounded-full",m?"bg-green-500":"bg-gray-300")}),(0,a.jsx)("span",{children:"Form Completion"})]})})]})]})})]})}var y=t(54861),w=t(78749),C=t(85339),k=t(53904);let V={enableConditionalContent:!0,enableFormatting:!0,enableNestedAccess:!0,strictMode:!1,maxDepth:5,missingVariablePlaceholder:"[variable not found]"},A={uppercase:{name:"uppercase",description:"Convert text to uppercase",example:"@name | uppercase",formatter:e=>String(e).toUpperCase()},lowercase:{name:"lowercase",description:"Convert text to lowercase",example:"@name | lowercase",formatter:e=>String(e).toLowerCase()},capitalize:{name:"capitalize",description:"Capitalize first letter of each word",example:"@name | capitalize",formatter:e=>String(e).replace(/\b\w/g,e=>e.toUpperCase())},currency:{name:"currency",description:"Format number as currency",example:"@price | currency",formatter:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{currency:"USD"},t=Number(e);return isNaN(t)?String(e):new Intl.NumberFormat("en-US",{style:"currency",currency:s.currency}).format(t)}},date:{name:"date",description:"Format date value",example:"@created_at | date",formatter:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{dateStyle:"medium"},t=new Date(e);return isNaN(t.getTime())?String(e):t.toLocaleDateString("en-US",s)}},truncate:{name:"truncate",description:"Truncate text to specified length",example:"@description | truncate:100",formatter:function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{length:50},t=String(e);return t.length>s.length?t.substring(0,s.length)+"...":t}}},S={basic:/@([a-zA-Z_][a-zA-Z0-9_]*)/g,nested:/@([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)/g,formatted:/@([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\s*\|\s*([a-zA-Z_][a-zA-Z0-9_]*(?::[^@\|\}]+)?)/g,conditional:/\{if\s+@([a-zA-Z_][a-zA-Z0-9_]*(?:\.[a-zA-Z_][a-zA-Z0-9_]*)*)\s*([=!<>]+\s*[^}]+)?\}([\s\S]*?)\{\/if\}/g};class z{interpolate(e,s){let t={success:!0,content:e,processedVariables:[],missingVariables:[],errors:[],warnings:[],usedConditionalRules:[]};try{let a=this.parseVariableReferences(e);a.errors.length>0&&t.errors.push(...a.errors),a.warnings.length>0&&t.warnings.push(...a.warnings);let l=e;this.options.enableConditionalContent&&(l=this.processConditionalContent(l,s,t)),l=this.replaceVariableReferences(l,s,t),t.content=l,t.success=0===t.errors.length}catch(e){t.success=!1,t.errors.push("Interpolation failed: ".concat(e instanceof Error?e.message:"Unknown error"))}return t}parseVariableReferences(e){let s={variables:[],blocks:[],errors:[],warnings:[]};try{let t=[{type:"formatted",regex:S.formatted},{type:"nested",regex:S.nested},{type:"basic",regex:S.basic}],a=new Set;t.forEach(t=>{let l,{type:i,regex:n}=t,r=new RegExp(n.source,n.flags);for(;null!==(l=r.exec(e));){l[0];let e=l[1],t="formatted"===i?l[2]:void 0;if(!a.has(e)){a.add(e);let l={name:e,path:e.includes(".")?e.split("."):void 0,formatter:t};s.variables.push(l)}}})}catch(e){s.errors.push("Failed to parse variable references: ".concat(e instanceof Error?e.message:"Unknown error"))}return s}addFormatter(e,s){this.formatters[e]=s}processConditionalContent(e,s,t){let a=new RegExp(S.conditional.source,S.conditional.flags);return e.replace(a,(e,a,l,i)=>{try{let e=this.getVariableValue(a,s);if(this.evaluateCondition(a,e,l,s))return t.usedConditionalRules.push("if ".concat(a)),i;return""}catch(s){return t.warnings.push("Failed to process conditional content for ".concat(a,": ").concat(s instanceof Error?s.message:"Unknown error")),e}})}replaceVariableReferences(e,s,t){return e=(e=e.replace(S.formatted,(e,a,l)=>this.processVariableReplacement(a,s,t,l))).replace(S.basic,(a,l)=>e.includes("@".concat(l," |"))||e.includes("@".concat(l,"|"))?a:this.processVariableReplacement(l,s,t))}processVariableReplacement(e,s,t,a){try{let l=this.getVariableValue(e,s);if(null==l)return t.missingVariables.push(e),this.options.missingVariablePlaceholder||"[".concat(e," not found]");if(t.processedVariables.push(e),a&&this.options.enableFormatting)return this.applyFormatter(l,a,t);return this.formatValue(l)}catch(s){return t.errors.push("Failed to process variable ".concat(e,": ").concat(s instanceof Error?s.message:"Unknown error")),"[Error: ".concat(e,"]")}}getVariableValue(e,s){if(!this.options.enableNestedAccess||!e.includes("."))return s.variables[e];let t=e.split("."),a=s.variables[t[0]];for(let e=1;e<t.length&&null!=a;e++)if("object"!=typeof a||!(t[e]in a))return;else a=a[t[e]];return a}applyFormatter(e,s,t){try{let[a,l]=s.split(":"),i=this.formatters[a];if(!i)return t.warnings.push("Unknown formatter: ".concat(a)),this.formatValue(e);let n={};if(l)try{l.includes("=")?l.split(",").forEach(e=>{let[s,t]=e.split("=");s&&t&&(n[s.trim()]=isNaN(Number(t))?t.trim():Number(t))}):n={length:Number(l)}}catch(e){}return i(e,n)}catch(s){return t.warnings.push("Formatter error: ".concat(s instanceof Error?s.message:"Unknown error")),this.formatValue(e)}}formatValue(e){return null==e?"":"object"==typeof e?JSON.stringify(e):String(e)}evaluateCondition(e,s,t,a){if(!t)return null!=s&&""!==s;try{let e=t.trim();if(e.startsWith("=")){let t=e.substring(1).trim();return String(s)===t}if(e.startsWith("!=")){let t=e.substring(2).trim();return String(s)!==t}if(e.startsWith(">")){let t=e.substring(1).trim();return Number(s)>Number(t)}if(e.startsWith("<")){let t=e.substring(1).trim();return Number(s)<Number(t)}return null!=s&&""!==s}catch(e){return null!=s&&""!==s}}constructor(e={}){this.options={...V,...e},this.formatters={},Object.entries(A).forEach(e=>{let[s,t]=e;this.formatters[s]=t.formatter})}}function T(e){let{result:s,isVisible:t,onToggle:l}=e;return t?(0,a.jsxs)("div",{className:"mt-2 p-3 bg-gray-50 rounded border space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Interpolation Debug Info"}),(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:l,className:"h-6 px-2",children:(0,a.jsx)(w.A,{className:"h-3 w-3"})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(d.E,{variant:s.success?"default":"destructive",children:s.success?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"h-3 w-3 mr-1"}),"Success"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"Failed"]})}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:[s.processedVariables.length," processed â€¢ ",s.missingVariables.length," missing"]})]}),s.processedVariables.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Processed Variables:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s.processedVariables.map((e,s)=>(0,a.jsxs)(d.E,{variant:"outline",className:"text-xs bg-green-50 text-green-700",children:["@",e]},s))})]}),s.missingVariables.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs font-medium text-amber-700 mb-1",children:"Missing Variables:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s.missingVariables.map((e,s)=>(0,a.jsxs)(d.E,{variant:"outline",className:"text-xs bg-amber-50 text-amber-700",children:["@",e]},s))})]}),s.usedConditionalRules.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs font-medium text-blue-700 mb-1",children:"Applied Rules:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s.usedConditionalRules.map((e,s)=>(0,a.jsx)(d.E,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:e},s))})]}),s.errors.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs font-medium text-red-700 mb-1",children:"Errors:"}),(0,a.jsx)("div",{className:"space-y-1",children:s.errors.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-1 text-xs text-red-600",children:[(0,a.jsx)(C.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:e})]},s))})]}),s.warnings.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs font-medium text-amber-700 mb-1",children:"Warnings:"}),(0,a.jsx)("div",{className:"space-y-1",children:s.warnings.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start space-x-1 text-xs text-amber-600",children:[(0,a.jsx)(C.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{children:e})]},s))})]})]}):(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2 p-2 bg-gray-50 rounded border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.E,{variant:s.success?"default":"destructive",className:"text-xs",children:s.success?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(j.A,{className:"h-3 w-3 mr-1"}),"Success"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"Failed"]})}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:[s.processedVariables.length," variables processed",s.missingVariables.length>0&&(0,a.jsxs)("span",{className:"text-amber-600 ml-1",children:["â€¢ ",s.missingVariables.length," missing"]})]})]}),(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:l,className:"h-6 px-2",children:(0,a.jsx)(p.A,{className:"h-3 w-3"})})]})}function R(e){let{content:s,highlightVariables:t}=e;if(!t)return(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:s}});let l=s.replace(/\[@([^\]]+) not found\]/g,'<span class="bg-red-100 text-red-700 px-1 rounded text-sm">[$1 not found]</span>').replace(/\[Error: ([^\]]+)\]/g,'<span class="bg-red-100 text-red-700 px-1 rounded text-sm">[Error: $1]</span>');return(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:l}})}function E(e){let{content:s,context:t,className:n,showPreview:r=!1,showDebugInfo:c=!1,onInterpolationResult:o,enableRealTimeProcessing:d=!0,fallbackContent:m="",highlightVariables:x=!1}=e,[u,h]=(0,l.useState)(!1),[p,g]=(0,l.useState)(!1),b=(0,l.useMemo)(()=>new z,[]),v=(0,l.useMemo)(()=>{if(!d)return{success:!0,content:s,processedVariables:[],missingVariables:[],errors:[],warnings:[],usedConditionalRules:[]};g(!0);try{return b.interpolate(s,t)}catch(e){return{success:!1,content:m||s,processedVariables:[],missingVariables:[],errors:["Processing failed: ".concat(e instanceof Error?e.message:"Unknown error")],warnings:[],usedConditionalRules:[]}}finally{g(!1)}},[s,t,b,d,m]);(0,l.useEffect)(()=>{null==o||o(v)},[v,o]);let j=(0,l.useMemo)(()=>r&&v.success?v.content:s,[r,v,s]);return(0,a.jsxs)("div",{className:(0,i.cn)("space-y-2",n),children:[p&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,a.jsx)(k.A,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{children:"Processing variables..."})]}),(0,a.jsx)("div",{className:(0,i.cn)("prose prose-sm max-w-none",!v.success&&"bg-red-50 border border-red-200 rounded p-3"),children:(0,a.jsx)(R,{content:j,highlightVariables:x})}),!v.success&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-red-600",children:[(0,a.jsx)(y.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Variable interpolation failed"})]}),v.missingVariables.length>0&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-amber-600",children:[(0,a.jsx)(C.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[v.missingVariables.length," variables missing"]})]}),c&&(0,a.jsx)(T,{result:v,isVisible:u,onToggle:()=>h(!u)})]})}function I(e){return e&&e.toLowerCase().replace(/[^a-z0-9\s]/g,"").replace(/\s+/g,"_").replace(/^_+|_+$/g,"").replace(/_+/g,"_").substring(0,50)||"untitled_variable"}var _=t(44940),P=t(27213),M=t(74311),F=t(91981),L=t(54416),W=t(4229),U=t(5196),$=t(99474),D=t(9727),Z=t(19144),J=t(15448),H=t(15968),B=t(89140),O=t(38164),q=t(81801),K=t(11004),Y=t(66474),G=t(13052),Q=t(94788);let X=[{id:"bold",label:"Bold Text",description:"Make text bold",icon:D.A,syntax:"**text**",example:"**Important note**"},{id:"italic",label:"Italic Text",description:"Make text italic",icon:Z.A,syntax:"*text*",example:"*Emphasis here*"},{id:"heading",label:"Heading",description:"Create a heading",icon:J.A,syntax:"# Heading",example:"# Section Title"},{id:"list",label:"Bullet List",description:"Create a bullet list",icon:H.A,syntax:"- Item",example:"- First item\n- Second item"},{id:"numbered",label:"Numbered List",description:"Create a numbered list",icon:B.A,syntax:"1. Item",example:"1. First step\n2. Second step"},{id:"link",label:"Link",description:"Create a hyperlink",icon:O.A,syntax:"[text](url)",example:"[Visit our website](https://example.com)"},{id:"variable",label:"Variable",description:"Insert a variable",icon:q.A,syntax:"@variableName",example:"@name, @email, @score"},{id:"conditional",label:"Conditional Content",description:"Show content based on conditions",icon:K.A,syntax:"{if @variable}content{/if}",example:"{if @score > 80}Excellent!{/if}"}],ee=[{value:">",label:"Greater than"},{value:"<",label:"Less than"},{value:">=",label:"Greater than or equal"},{value:"<=",label:"Less than or equal"},{value:"=",label:"Equal to"},{value:"!=",label:"Not equal to"},{value:"contains",label:"Contains"},{value:"starts_with",label:"Starts with"},{value:"ends_with",label:"Ends with"}];function es(e){let{onInsert:s,enableVariables:t=!0,enableConditionals:l=!0}=e,i=X.filter(e=>(!!t||"variable"!==e.id)&&(!!l||"conditional"!==e.id));return(0,a.jsx)("div",{className:"flex flex-wrap gap-1 p-2 bg-gray-50 border-b",children:i.map(e=>{let t=e.icon;return(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>s(e.syntax),className:"h-8 px-2",title:"".concat(e.label,": ").concat(e.syntax),children:(0,a.jsx)(t,{className:"h-3 w-3"})},e.id)})})}function et(e){let{onInsert:s,availableVariables:t=[]}=e,[i,d]=(0,l.useState)({id:Date.now().toString(),variable:"",operator:">",value:"",content:""}),[m,x]=(0,l.useState)(!1);return(0,a.jsxs)(n.Zp,{className:"border-dashed",children:[(0,a.jsx)(n.aR,{className:"cursor-pointer py-3",onClick:()=>x(!m),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Conditional Content"})]}),m?(0,a.jsx)(Y.A,{className:"h-4 w-4"}):(0,a.jsx)(G.A,{className:"h-4 w-4"})]})}),m&&(0,a.jsxs)(n.Wu,{className:"pt-0 space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs",children:"Variable"}),(0,a.jsxs)("select",{value:i.variable,onChange:e=>d({...i,variable:e.target.value}),className:"w-full text-sm border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"",children:"Select variable..."}),t.map(e=>(0,a.jsxs)("option",{value:e,children:["@",e]},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs",children:"Operator"}),(0,a.jsx)("select",{value:i.operator,onChange:e=>d({...i,operator:e.target.value}),className:"w-full text-sm border rounded px-2 py-1",children:ee.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs",children:"Value"}),(0,a.jsx)(c.p,{value:i.value,onChange:e=>d({...i,value:e.target.value}),placeholder:"Comparison value...",className:"text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs",children:"Content to show"}),(0,a.jsx)($.T,{value:i.content,onChange:e=>d({...i,content:e.target.value}),placeholder:"Content to display when condition is true...",className:"text-sm",rows:2})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>x(!1),children:"Cancel"}),(0,a.jsx)(r.$,{size:"sm",onClick:()=>{i.variable&&i.content&&(s("{if @".concat(i.variable," ").concat(i.operator," ").concat(i.value,"}").concat(i.content,"{/if}")),d({id:Date.now().toString(),variable:"",operator:">",value:"",content:""}),x(!1))},disabled:!i.variable||!i.content,children:"Insert Conditional"})]})]})]})}function ea(){let[e,s]=(0,l.useState)(!1);return(0,a.jsxs)(n.Zp,{className:"border-blue-200 bg-blue-50",children:[(0,a.jsx)(n.aR,{className:"cursor-pointer py-3",onClick:()=>s(!e),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(Q.A,{className:"h-4 w-4 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Formatting Help"})]}),e?(0,a.jsx)(Y.A,{className:"h-4 w-4 text-blue-600"}):(0,a.jsx)(G.A,{className:"h-4 w-4 text-blue-600"})]})}),e&&(0,a.jsxs)(n.Wu,{className:"pt-0 space-y-3",children:[(0,a.jsx)("div",{className:"grid grid-cols-1 gap-2 text-xs",children:X.map(e=>(0,a.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,a.jsxs)("span",{className:"text-blue-800",children:[e.label,":"]}),(0,a.jsx)("code",{className:"bg-white px-2 py-1 rounded border text-blue-900",children:e.syntax})]},e.id))}),(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-blue-200",children:(0,a.jsxs)("div",{className:"text-xs text-blue-700",children:[(0,a.jsx)("strong",{children:"Variable Examples:"}),(0,a.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-white px-1 rounded",children:"@name"})," - User's name"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-white px-1 rounded",children:"@score"})," - Calculated score"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-white px-1 rounded",children:"@recommendation"})," - AI recommendation"]})]})]})})]})]})}function el(e){let{content:s,onChange:t,variableContext:c,className:m,placeholder:x="Enter your content...",enablePreview:u=!0,enableVariables:h=!0,enableFormatting:g=!0,enableConditionals:b=!0,maxHeight:v="400px"}=e,[j,f]=(0,l.useState)(!1),[N,y]=(0,l.useState)(!1),w=(0,l.useRef)(null),C=(0,l.useMemo)(()=>{var e;return(null==c||null==(e=c.availableVariables)?void 0:e.map(e=>e.name))||[]},[null==c?void 0:c.availableVariables]),k=(0,l.useCallback)(e=>{if(!w.current)return;let a=w.current,l=a.selectionStart,i=a.selectionEnd,n=s.substring(l,i),r=s,c=l;if(e.includes("text")){let t=e.replace("text",n||"text");r=s.substring(0,l)+t+s.substring(i),c=l+t.length}else if(e.includes("url")){let t=e.replace("text",n||"link text");r=s.substring(0,l)+t+s.substring(i),c=l+t.indexOf("url")}else r=s.substring(0,l)+e+s.substring(i),c=l+e.length;t(r),setTimeout(()=>{w.current&&(w.current.focus(),w.current.setSelectionRange(c,c))},0)},[s,t]),V=(0,l.useCallback)(e=>{if(!w.current)return;let a=w.current.selectionStart;t(s.substring(0,a)+e+s.substring(a)),setTimeout(()=>{w.current&&(w.current.focus(),w.current.setSelectionRange(a+e.length,a+e.length))},0)},[s,t]);return(0,a.jsxs)("div",{className:(0,i.cn)("space-y-3",m),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(o.J,{className:"text-sm font-medium",children:"Content Editor"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>y(!N),children:[(0,a.jsx)(Q.A,{className:"h-4 w-4 mr-1"}),"Help"]}),u&&(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>f(!j),children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),j?"Edit":"Preview"]})]})]}),N&&(0,a.jsx)(ea,{}),(0,a.jsxs)(n.Zp,{children:[g&&!j&&(0,a.jsx)(es,{onInsert:k,enableVariables:h,enableConditionals:b}),(0,a.jsx)(n.Wu,{className:"p-0",children:j?(0,a.jsx)("div",{className:"p-4 min-h-[200px]",children:c?(0,a.jsx)(E,{content:s,context:c,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:!0}):(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:s}})})}):(0,a.jsx)($.T,{ref:w,value:s,onChange:e=>t(e.target.value),placeholder:x,className:"border-0 resize-none focus:ring-0 text-sm",style:{maxHeight:v,minHeight:"200px"}})})]}),b&&!j&&(0,a.jsx)(et,{onInsert:V,availableVariables:C}),h&&C.length>0&&!j&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600",children:"Available Variables:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[C.slice(0,8).map(e=>(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>k("@".concat(e)),className:"h-6 px-2 text-xs",children:[(0,a.jsx)(q.A,{className:"h-3 w-3 mr-1"}),e]},e)),C.length>8&&(0,a.jsxs)(d.E,{variant:"outline",className:"text-xs",children:["+",C.length-8," more"]})]})]})]})}var ei=t(87325),en=t(67733),er=t(88702),ec=t(57918),eo=t(2965),ed=t(29869),em=t(14395);let ex=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]},eu=()=>"img_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,15));function eh(e){let{image:s,onUpdate:t,onRemove:m,enableSizing:x,enablePositioning:u}=e,[h,p]=(0,l.useState)(!1),g=e=>{t({position:e})},b=e=>{t({sizing:e})},v=(e,s)=>{t({sizing:"custom",customWidth:e,customHeight:s})};return(0,a.jsx)(n.Zp,{className:"relative group",children:(0,a.jsxs)(n.Wu,{className:"p-4 space-y-4",children:[(0,a.jsxs)("div",{className:(0,i.cn)("relative overflow-hidden rounded-lg bg-gray-100","left"===s.position&&"ml-0 mr-auto","center"===s.position&&"mx-auto","right"===s.position&&"ml-auto mr-0","full"===s.position&&"w-full"),children:[(0,a.jsx)("img",{src:s.url,alt:s.alt||s.name,className:(0,i.cn)("object-cover","small"===s.sizing&&"w-32 h-32","medium"===s.sizing&&"w-48 h-48","large"===s.sizing&&"w-64 h-64","custom"===s.sizing&&s.customWidth&&s.customHeight&&"w-[".concat(s.customWidth,"px] h-[").concat(s.customHeight,"px]"),!s.sizing&&"w-48 h-48"),style:"custom"===s.sizing&&(s.customWidth||s.customHeight)?{width:s.customWidth?"".concat(s.customWidth,"px"):"auto",height:s.customHeight?"".concat(s.customHeight,"px"):"auto"}:void 0}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-200 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex space-x-2",children:[(0,a.jsx)(r.$,{variant:"secondary",size:"sm",onClick:()=>p(!h),children:(0,a.jsx)(eo.A,{className:"h-4 w-4"})}),(0,a.jsx)(r.$,{variant:"destructive",size:"sm",onClick:m,children:(0,a.jsx)(L.A,{className:"h-4 w-4"})})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium truncate",children:s.name}),(0,a.jsx)(d.E,{variant:"outline",className:"text-xs",children:ex(s.size)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600",children:"Alt Text"}),(0,a.jsx)(c.p,{value:s.alt||"",onChange:e=>t({alt:e.target.value}),placeholder:"Describe this image...",className:"text-xs h-8"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600",children:"Caption (optional)"}),(0,a.jsx)(c.p,{value:s.caption||"",onChange:e=>t({caption:e.target.value}),placeholder:"Image caption...",className:"text-xs h-8"})]})]}),h&&(0,a.jsxs)("div",{className:"space-y-4 pt-4 border-t",children:[u&&(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600 mb-2 block",children:"Position"}),(0,a.jsx)("div",{className:"flex space-x-1",children:[{value:"left",label:"Left",icon:ei.A},{value:"center",label:"Center",icon:en.A},{value:"right",label:"Right",icon:er.A},{value:"full",label:"Full Width",icon:ec.A}].map(e=>{let{value:t,label:l,icon:i}=e;return(0,a.jsx)(r.$,{variant:s.position===t?"default":"outline",size:"sm",onClick:()=>g(t),className:"h-8 px-2",title:l,children:(0,a.jsx)(i,{className:"h-3 w-3"})},t)})})]}),x&&(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600 mb-2 block",children:"Size"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("div",{className:"flex space-x-1",children:[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"},{value:"custom",label:"Custom"}].map(e=>{let{value:t,label:l}=e;return(0,a.jsx)(r.$,{variant:s.sizing===t?"default":"outline",size:"sm",onClick:()=>b(t),className:"h-8 px-3 text-xs",children:l},t)})}),"custom"===s.sizing&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-500",children:"Width (px)"}),(0,a.jsx)(c.p,{type:"number",value:s.customWidth||"",onChange:e=>v(parseInt(e.target.value)||void 0,s.customHeight),placeholder:"Auto",className:"text-xs h-8"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-500",children:"Height (px)"}),(0,a.jsx)(c.p,{type:"number",value:s.customHeight||"",onChange:e=>v(s.customWidth,parseInt(e.target.value)||void 0),placeholder:"Auto",className:"text-xs h-8"})]})]})]})]})]})]})})}function ep(e){let{value:s,onChange:t,className:d,maxSizeKB:m=5e3,acceptedFormats:x=["image/jpeg","image/png","image/gif","image/webp"],showPreview:u=!0,enableSizing:h=!0,enablePositioning:p=!0,enableMediaLibrary:g=!1,placeholder:b="Upload an image or drag and drop"}=e,[v,j]=(0,l.useState)(!1),[f,N]=(0,l.useState)(!1),[y,w]=(0,l.useState)(null),C=(0,l.useRef)(null),k=e=>x.includes(e.type)?e.size>1024*m?"File too large. Maximum size: ".concat(ex(1024*m)):null:"Invalid file format. Accepted formats: ".concat(x.map(e=>e.split("/")[1]).join(", ")),V=(0,l.useCallback)(async e=>{N(!0),w(null);try{let s=k(e);if(s)return void w(s);let a=URL.createObjectURL(e),l=new Image;l.onload=()=>{let s={id:eu(),url:a,name:e.name,size:e.size,type:e.type,width:l.width,height:l.height,position:"center",sizing:"medium"};t(s),URL.revokeObjectURL(a)},l.src=a}catch(e){w(e instanceof Error?e.message:"Upload failed")}finally{N(!1)}},[t,m,x]),A=(0,l.useCallback)(e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];t&&V(t)},[V]),S=(0,l.useCallback)(e=>{e.preventDefault(),j(!0)},[]),z=(0,l.useCallback)(e=>{e.preventDefault(),j(!1)},[]),T=(0,l.useCallback)(e=>{e.preventDefault(),j(!1);let s=e.dataTransfer.files[0];s&&V(s)},[V]),R=(0,l.useCallback)(()=>{(null==s?void 0:s.url)&&URL.revokeObjectURL(s.url),t(null)},[s,t]),E=(0,l.useCallback)(e=>{s&&t({...s,...e})},[s,t]);return s&&u?(0,a.jsx)("div",{className:d,children:(0,a.jsx)(eh,{image:s,onUpdate:E,onRemove:R,enableSizing:h,enablePositioning:p})}):(0,a.jsxs)("div",{className:(0,i.cn)("space-y-3",d),children:[(0,a.jsx)(n.Zp,{className:(0,i.cn)("border-2 border-dashed transition-colors cursor-pointer",v?"border-blue-500 bg-blue-50":"border-gray-300",f&&"opacity-50 cursor-not-allowed"),onDragOver:S,onDragLeave:z,onDrop:T,onClick:()=>{var e;return!f&&(null==(e=C.current)?void 0:e.click())},children:(0,a.jsxs)(n.Wu,{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,a.jsx)("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:f?(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-gray-600"}):(0,a.jsx)(ed.A,{className:"h-6 w-6 text-gray-600"})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:f?"Uploading...":b}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[x.map(e=>e.split("/")[1]).join(", ")," up to ",ex(1024*m)]})]}),!f&&(0,a.jsxs)("div",{className:"flex space-x-2 mt-4",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Choose File"]}),g&&(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)(em.A,{className:"h-4 w-4 mr-2"}),"Media Library"]})]})]})}),(0,a.jsx)("input",{ref:C,type:"file",accept:x.join(","),onChange:A,className:"hidden"}),y&&(0,a.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(L.A,{className:"h-4 w-4 text-red-600"}),(0,a.jsx)("span",{className:"text-sm text-red-800",children:y})]})}),(0,a.jsx)(n.Zp,{className:"border-dashed",children:(0,a.jsxs)(n.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(O.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)(o.J,{className:"text-sm text-gray-600",children:"Or add image URL:"})]}),(0,a.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,a.jsx)(c.p,{placeholder:"https://example.com/image.jpg",className:"text-sm",onKeyDown:e=>{if("Enter"===e.key&&e.currentTarget.value){let s=e.currentTarget.value;t({id:eu(),url:s,name:s.split("/").pop()||"Image",size:0,type:"image/jpeg",position:"center",sizing:"medium"}),e.currentTarget.value=""}}}),(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:e=>{let s=e.currentTarget.previousElementSibling;if(null==s?void 0:s.value){let e=s.value;t({id:eu(),url:e,name:e.split("/").pop()||"Image",size:0,type:"image/jpeg",position:"center",sizing:"medium"}),s.value=""}},children:"Add"})]})]})})]})}let eg=e=>{let s=[],t=0;return s.push({id:"block_".concat(Date.now()),type:"text",content:e,order:t++}),s};function eb(e){let{content:s,onChange:t,className:n,placeholder:c="Click to edit content...",enableRichText:o=!0,enableImages:m=!0,enableVariables:x=!0,variableContext:u,autoSave:h=!1,autoSaveDelay:g=1e3,maxLength:b,showWordCount:v=!1,allowFullscreen:j=!0}=e,[f,N]=(0,l.useState)({type:"view",fullscreen:!1}),[y,w]=(0,l.useState)(s),[C,k]=(0,l.useState)(!1),[V,A]=(0,l.useState)(null),S=(0,l.useMemo)(()=>eg(y),[y]),z=(0,l.useCallback)(e=>{if(w(e),k(e!==s),h){let s=setTimeout(()=>{t(e),k(!1)},g);return()=>clearTimeout(s)}},[s,t,h,g]),T=(0,l.useCallback)(()=>{t(y),k(!1),N(e=>({...e,type:"view"}))},[y,t]),R=(0,l.useCallback)(()=>{w(s),k(!1),N(e=>({...e,type:"view"}))},[s]),I=(0,l.useCallback)(e=>{"block_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(2,15)),S.length,"text"===e?z(y+"\n\n\x3c!-- New text block --\x3e"):z(y+"\n\n\x3c!-- Image placeholder --\x3e")},[S.length,y,z]),$=(0,l.useCallback)(e=>{N(s=>({...s,type:e}))},[]),D=(0,l.useCallback)(()=>{N(e=>({...e,fullscreen:!e.fullscreen}))},[]),Z=(0,l.useMemo)(()=>y.trim().split(/\s+/).filter(e=>e.length>0).length,[y]),J=()=>(0,a.jsxs)("div",{className:(0,i.cn)("group relative min-h-[120px] p-4 border border-transparent rounded-lg cursor-pointer transition-all hover:border-gray-200 hover:bg-gray-50",!s&&"text-gray-500 italic"),onClick:()=>$("edit"),children:[s?(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:x&&u?(0,a.jsx)(E,{content:s,context:u,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:!1,onInterpolationResult:A}):(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:s}})}):(0,a.jsx)("span",{children:c}),(0,a.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(0,a.jsx)(r.$,{variant:"ghost",size:"sm",children:(0,a.jsx)(_.A,{className:"h-4 w-4"})})})]}),H=()=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(el,{content:y,onChange:z,variableContext:u,enablePreview:!1,enableVariables:x,enableFormatting:o,enableConditionals:x,placeholder:c,maxHeight:f.fullscreen?"70vh":"400px"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[m&&(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>I("image"),children:[(0,a.jsx)(P.A,{className:"h-4 w-4 mr-1"}),"Add Image"]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>$("preview"),children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Preview"]}),j&&(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:D,children:f.fullscreen?(0,a.jsx)(M.A,{className:"h-4 w-4"}):(0,a.jsx)(F.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:R,children:[(0,a.jsx)(L.A,{className:"h-4 w-4 mr-1"}),"Cancel"]}),(0,a.jsxs)(r.$,{size:"sm",onClick:T,disabled:!C,children:[(0,a.jsx)(W.A,{className:"h-4 w-4 mr-1"}),"Save"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 pt-2 border-t",children:[(0,a.jsxs)("div",{className:"flex space-x-4",children:[v&&(0,a.jsxs)("span",{children:[Z," words",b&&" / ".concat(b," max")]}),V&&(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(d.E,{variant:"outline",className:"text-xs",children:[V.processedVariables.length," variables"]}),V.missingVariables.length>0&&(0,a.jsxs)(d.E,{variant:"destructive",className:"text-xs",children:[V.missingVariables.length," missing"]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[C&&(0,a.jsx)(d.E,{variant:"outline",className:"text-xs",children:"Unsaved changes"}),h&&!C&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(U.A,{className:"h-3 w-3 text-green-600"}),(0,a.jsx)("span",{className:"text-green-600",children:"Auto-saved"})]})]})]})]}),B=()=>(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"prose prose-sm max-w-none border rounded-lg p-4 bg-gray-50",children:x&&u?(0,a.jsx)(E,{content:y,context:u,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:!0,showDebugInfo:!0}):(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:y}})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>$("edit"),children:[(0,a.jsx)(_.A,{className:"h-4 w-4 mr-1"}),"Edit"]}),(0,a.jsxs)(r.$,{size:"sm",onClick:T,disabled:!C,children:[(0,a.jsx)(W.A,{className:"h-4 w-4 mr-1"}),"Save Preview"]})]})]}),O=()=>{switch(f.type){case"edit":return H();case"preview":return B();default:return J()}};return f.fullscreen?(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-white",children:(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-4 border-b bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Content Editor"}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:D,children:[(0,a.jsx)(M.A,{className:"h-4 w-4 mr-1"}),"Exit Fullscreen"]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-auto p-4",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto",children:O()})})]})}):(0,a.jsx)("div",{className:(0,i.cn)("space-y-2",n),children:O()})}var ev=t(14738),ej=t(52280),ef=t(46767),eN=t(40133);let ey={desktop:{name:"Desktop",icon:ev.A,width:1200,height:800,maxWidth:"100%",description:"Full desktop experience"},tablet:{name:"Tablet",icon:ej.A,width:768,height:1024,maxWidth:"768px",description:"iPad and tablet devices"},mobile:{name:"Mobile",icon:ef.A,width:375,height:667,maxWidth:"375px",description:"iPhone and mobile devices"}};function ew(e){let{device:s,orientation:t,children:n,showFrame:r=!0}=e,c=ey[s],o=(0,l.useMemo)(()=>{if(!r||"desktop"===s)return{width:"100%",maxWidth:c.maxWidth,minHeight:"desktop"===s?"600px":"400px"};let e="landscape"===t,a=e?Math.max(c.width,c.height):c.width,l=e?Math.min(c.width,c.height):c.height;return{width:"".concat(a,"px"),height:"".concat(l,"px"),maxWidth:"100%"}},[s,t,c,r]);return r&&"desktop"!==s?(0,a.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:(0,i.cn)("relative bg-gray-900 rounded-[2rem] p-2 shadow-2xl","mobile"===s&&"rounded-[2.5rem]","tablet"===s&&"rounded-[1.5rem]"),style:o,children:[(0,a.jsxs)("div",{className:(0,i.cn)("bg-white rounded-[1.5rem] w-full h-full overflow-hidden relative","mobile"===s&&"rounded-[2rem]","tablet"===s&&"rounded-[1rem]"),children:["mobile"===s&&(0,a.jsxs)("div",{className:"h-6 bg-gray-50 flex items-center justify-between px-4 text-xs",children:[(0,a.jsx)("span",{className:"font-medium",children:"9:41"}),(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)("div",{className:"w-4 h-2 bg-gray-300 rounded-sm"}),(0,a.jsx)("div",{className:"w-6 h-2 bg-green-500 rounded-sm"})]})]}),(0,a.jsx)("div",{className:(0,i.cn)("w-full overflow-auto","mobile"===s?"h-[calc(100%-1.5rem)]":"h-full"),children:n})]}),"mobile"===s&&(0,a.jsx)("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2 w-12 h-1 bg-gray-600 rounded-full"})]})}):(0,a.jsx)("div",{className:"w-full",style:o,children:n})}function eC(e){let{children:s,className:t,enableDeviceToggle:c=!0,enableOrientationToggle:o=!0,showDeviceFrame:m=!0,defaultDevice:x="desktop",onDeviceChange:u}=e,[h,g]=(0,l.useState)(x),[b,v]=(0,l.useState)("portrait"),[j,f]=(0,l.useState)(!1),N=e=>{g(e),null==u||u(e),"desktop"===e&&v("portrait")},y=()=>{"desktop"!==h&&v(e=>"portrait"===e?"landscape":"portrait")},w=()=>{f(!j)},C=()=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 border-b",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Preview"}),(0,a.jsxs)(d.E,{variant:"outline",className:"text-xs",children:[ey[h].name,"desktop"!==h&&"landscape"===b&&" (Landscape)"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&(0,a.jsx)("div",{className:"flex border rounded-lg overflow-hidden",children:Object.entries(ey).map(e=>{let[s,t]=e,l=t.icon;return(0,a.jsx)(r.$,{variant:h===s?"default":"ghost",size:"sm",onClick:()=>N(s),className:"h-8 px-3 rounded-none border-0",title:t.description,children:(0,a.jsx)(l,{className:"h-3 w-3"})},s)})}),o&&"desktop"!==h&&(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:y,className:"h-8 px-2",title:"Switch to ".concat("portrait"===b?"landscape":"portrait"),children:(0,a.jsx)(eN.A,{className:"h-3 w-3"})}),(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:w,className:"h-8 px-2",title:j?"Exit fullscreen":"Enter fullscreen",children:j?(0,a.jsx)(M.A,{className:"h-3 w-3"}):(0,a.jsx)(F.A,{className:"h-3 w-3"})})]})]});return j?(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-white",children:(0,a.jsxs)("div",{className:"h-full flex flex-col",children:[C(),(0,a.jsx)("div",{className:"flex-1 overflow-auto bg-gray-100",children:(0,a.jsx)(ew,{device:h,orientation:b,showFrame:m,children:s})})]})}):(0,a.jsxs)(n.Zp,{className:(0,i.cn)("overflow-hidden",t),children:[C(),(0,a.jsx)(n.Wu,{className:"p-0 bg-gray-100",children:(0,a.jsx)(ew,{device:h,orientation:b,showFrame:m,children:s})})]})}function ek(e){let{section:s,isPreview:t=!1,onUpdate:v,className:j}=e,f=s.settings,[y,w]=(0,l.useState)(!1),[C,k]=(0,l.useState)(!1),V=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[a,i]=(0,l.useState)({availableVariables:[],variableMap:new Map,isLoading:!0,error:void 0});(0,l.useEffect)(()=>{i(e=>({...e,isLoading:!0,error:void 0}));try{let a={includePreviewValues:t.includePreviewValues,filterByType:t.filterByType,excludeSectionTypes:t.excludeSectionTypes},l=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=[...e].sort((e,s)=>e.order-s.order),a=[];for(let e of t){let t=function(e){var s,t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=[];if(!e.isVisible||(null==(s=a.excludeSectionTypes)?void 0:s.includes(e.type)))return l;switch(e.type){case"question-text":l.push({id:"".concat(e.id,"_response"),name:I(e.title),displayName:e.title||"Text Response",type:"text",description:"Text response from: ".concat(e.title),sectionId:e.id,sectionTitle:e.title,sectionType:e.type,previewValue:a.includePreviewValues?"Sample text response...":void 0,source:"user_input"});break;case"question-multiple-choice":let i=e.settings,n=(null==i?void 0:i.selectionType)||"single";l.push({id:"".concat(e.id,"_response"),name:I(e.title),displayName:e.title||"Choice Response",type:"multiple"===n?"array":"text",description:"".concat("multiple"===n?"Multiple choice":"Single choice"," response from: ").concat(e.title),sectionId:e.id,sectionTitle:e.title,sectionType:e.type,previewValue:a.includePreviewValues?"multiple"===n?'["Option 1", "Option 2"]':"Option 1":void 0,source:"user_input"});break;case"question-slider":l.push({id:"".concat(e.id,"_response"),name:I(e.title),displayName:e.title||"Slider Value",type:"number",description:"Numeric slider value from: ".concat(e.title),sectionId:e.id,sectionTitle:e.title,sectionType:e.type,previewValue:a.includePreviewValues?"75":void 0,source:"user_input"});break;case"capture":let r=e.settings,c=(null==r?void 0:r.enabledFields)||{};c.name&&l.push({id:"".concat(e.id,"_name"),name:I("".concat(e.title,"_name")),displayName:"".concat(e.title," - Name"),type:"text",description:"Name field from: ".concat(e.title),sectionId:e.id,sectionTitle:e.title,sectionType:e.type,previewValue:a.includePreviewValues?"John Doe":void 0,source:"user_input"}),c.email&&l.push({id:"".concat(e.id,"_email"),name:I("".concat(e.title,"_email")),displayName:"".concat(e.title," - Email"),type:"text",description:"Email field from: ".concat(e.title),sectionId:e.id,sectionTitle:e.title,sectionType:e.type,previewValue:a.includePreviewValues?"john@example.com":void 0,source:"user_input"}),c.phone&&l.push({id:"".concat(e.id,"_phone"),name:I("".concat(e.title,"_phone")),displayName:"".concat(e.title," - Phone"),type:"text",description:"Phone field from: ".concat(e.title),sectionId:e.id,sectionTitle:e.title,sectionType:e.type,previewValue:a.includePreviewValues?"+1 (555) 123-4567":void 0,source:"user_input"})}return(null==(t=a.filterByType)?void 0:t.length)?l.filter(e=>a.filterByType.includes(e.type)):l}(e,s);a.push(...t)}return a}(e.filter(e=>e.order<s&&e.isVisible),t)}(e,s,a),n=new Map;l.forEach(e=>{n.set(e.name,e),n.set("@".concat(e.name),e)}),i({availableVariables:l,variableMap:n,isLoading:!1,error:void 0})}catch(e){i(s=>({...s,isLoading:!1,error:e instanceof Error?e.message:"Failed to extract variables"}))}},[e,s,t.includePreviewValues,t.filterByType,t.excludeSectionTypes]);let n=(0,l.useMemo)(()=>({getVariable:e=>a.variableMap.get(e.startsWith("@")?e:"@".concat(e)),hasVariable:e=>a.variableMap.has(e.startsWith("@")?e:"@".concat(e)),getVariableSuggestions:e=>{if(!e||e.length<1)return a.availableVariables.map(e=>({variable:e,matchScore:1,displayText:"@".concat(e.name)}));let s=e.toLowerCase().replace(/^@/,"");return a.availableVariables.map(e=>{let t=e.name.toLowerCase(),a=e.displayName.toLowerCase(),l=0;return t===s?l=100:t.startsWith(s)?l=80:a.startsWith(s)?l=60:t.includes(s)?l=40:a.includes(s)&&(l=20),{variable:e,matchScore:l,displayText:"@".concat(e.name)}}).filter(e=>e.matchScore>0).sort((e,s)=>s.matchScore-e.matchScore)},replaceVariableMentions:function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"{{VARIABLE}}";return e.replace(/@(\w+)/g,(e,l)=>{let i=a.variableMap.get("@".concat(l));return i?(null==s?void 0:s.get(l))||i.previewValue||t.replace("{{VARIABLE}}",l):e})},extractVariableMentions:e=>(e.match(/@(\w+)/g)||[]).map(e=>e.substring(1)).filter((e,s,t)=>t.indexOf(e)===s).filter(e=>a.variableMap.has("@".concat(e))),validateVariableMentions:e=>{let s=e.match(/@(\w+)/g)||[],t=[];for(let e of s){let s=e.substring(1);a.variableMap.has("@".concat(s))||t.includes(s)||t.push(s)}return{isValid:0===t.length,invalidVariables:t}},getVariablesBySection:()=>{let e={};return a.availableVariables.forEach(s=>{let t=s.sectionTitle||"Untitled Section";e[t]||(e[t]=[]),e[t].push(s)}),e}}),[a.availableVariables,a.variableMap]);return{...a,...n}}([],0).availableVariables||[],A=(0,l.useMemo)(()=>{let e={};return V.forEach(s=>{"text"===s.type?e[s.name]="Sample ".concat(s.name):"number"===s.type?e[s.name]=42:"boolean"===s.type?e[s.name]=!0:"array"===s.type?e[s.name]=["Option 1","Option 2"]:"object"===s.type?e[s.name]={sample:"data"}:e[s.name]="Sample ".concat(s.name)}),e.name="John Doe",e.email="john@example.com",e.score=85,e.recommendation="You are doing great! Keep up the excellent work.",e},[V]),S=(0,l.useMemo)(()=>({variables:A,availableVariables:V,formatters:{},conditionalRules:f.conditionalContent||[]}),[A,V,f.conditionalContent]);(0,b.v)(f.title||"Your Results",{onSave:async e=>{await v({settings:{...f,title:e}})}});let z=async e=>{await v({settings:{...f,content:e}})},T=async e=>{await v({settings:{...f,headerImage:e,enableVariableInterpolation:!1!==f.enableVariableInterpolation}})},R=async e=>{await v({settings:{...f,enableVariableInterpolation:e}})};return t?(0,a.jsx)(N,{className:j,children:(0,a.jsx)("div",{className:"py-8",children:(()=>{let e=!1!==f.enableVariableInterpolation;switch(s.type){case"output-results":return(0,a.jsxs)(n.Zp,{className:"w-full max-w-2xl mx-auto",children:[f.headerImage&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:f.headerImage.url,alt:f.headerImage.alt||"Header image",className:(0,i.cn)("w-full object-cover rounded-t-lg","small"===f.headerImage.sizing&&"h-32","medium"===f.headerImage.sizing&&"h-48","large"===f.headerImage.sizing&&"h-64",!f.headerImage.sizing&&"h-48")}),f.headerImage.caption&&(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-2",children:f.headerImage.caption})]}),(0,a.jsx)(n.aR,{className:"text-center",children:(0,a.jsx)(n.ZB,{className:"text-2xl font-bold",children:e?(0,a.jsx)(E,{content:f.title,context:S,showPreview:!0,enableRealTimeProcessing:!0}):f.title})}),(0,a.jsxs)(n.Wu,{className:"space-y-4",children:[(0,a.jsx)("div",{className:"prose prose-sm max-w-none",children:e?(0,a.jsx)(E,{content:f.content,context:S,showPreview:!0,enableRealTimeProcessing:!0,highlightVariables:t}):(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:f.content}})}),f.showScore&&(0,a.jsx)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-600",children:e?(0,a.jsx)(E,{content:"Score: @score/100",context:S,showPreview:!0,enableRealTimeProcessing:!0}):"Score: 85/100"})})]})]});case"output-download":return(0,a.jsxs)(n.Zp,{className:"w-full max-w-md mx-auto",children:[(0,a.jsx)(n.aR,{className:"text-center",children:(0,a.jsx)(n.ZB,{className:"text-xl font-bold",children:e?(0,a.jsx)(E,{content:f.title,context:S,showPreview:!0,enableRealTimeProcessing:!0}):f.title})}),(0,a.jsxs)(n.Wu,{className:"text-center space-y-4",children:[(0,a.jsx)("div",{className:"text-gray-600",children:e?(0,a.jsx)(E,{content:f.content,context:S,showPreview:!0,enableRealTimeProcessing:!0}):f.content}),(0,a.jsxs)(r.$,{className:"w-full",onClick:()=>{f.fileUrl&&window.open(f.fileUrl,"_blank")},disabled:!f.fileUrl,children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),e?(0,a.jsx)(E,{content:f.fileName||"Download @name Report",context:S,showPreview:!0,enableRealTimeProcessing:!0}):f.fileName||"Download Resource"]})]})]});case"output-redirect":return(0,a.jsx)(n.Zp,{className:"w-full max-w-md mx-auto",children:(0,a.jsxs)(n.Wu,{className:"text-center space-y-4 pt-6",children:[(0,a.jsx)("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(u.A,{className:"h-6 w-6 text-blue-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e?(0,a.jsx)(E,{content:f.message||"Redirecting @name...",context:S,showPreview:!0,enableRealTimeProcessing:!0}):f.message||"Redirecting..."}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["You will be redirected in ",f.delay||0," seconds"]})]})]})});default:return(0,a.jsx)(n.Zp,{className:"w-full max-w-md mx-auto",children:(0,a.jsxs)(n.Wu,{className:"text-center space-y-4 pt-6",children:[(0,a.jsx)("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(h.A,{className:"h-6 w-6 text-gray-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:e?(0,a.jsx)(E,{content:f.title,context:S,showPreview:!0,enableRealTimeProcessing:!0}):f.title}),(0,a.jsx)("div",{className:"text-sm text-gray-500 mt-1",children:e?(0,a.jsx)(E,{content:f.content,context:S,showPreview:!0,enableRealTimeProcessing:!0}):f.content})]})]})})}})()})}):(0,a.jsxs)("div",{className:(0,i.cn)("space-y-6",j),children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 text-emerald-600"}),(0,a.jsx)(d.E,{variant:"outline",className:"bg-emerald-50 text-emerald-700 border-emerald-200",children:"output-results"===s.type?"Results Page":"output-download"===s.type?"Download Link":"output-redirect"===s.type?"Redirect":"Output"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Title"}),(0,a.jsx)(eb,{content:f.title||"Your Results",onChange:async e=>{await v({settings:{...f,title:e}})},placeholder:"Enter section title...",enableRichText:!1,enableImages:!1,enableVariables:!1!==f.enableVariableInterpolation,variableContext:S,className:"mt-1"}),f.enableVariableInterpolation&&(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Use @variableName to insert dynamic content. Examples: @name, @score, @recommendation"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Content"}),(0,a.jsx)(eb,{content:f.content||"Based on your answers...",onChange:z,placeholder:"Enter section content...",enableRichText:!0,enableImages:!0,enableVariables:!1!==f.enableVariableInterpolation,variableContext:S,showWordCount:!0,allowFullscreen:!0,className:"mt-1"}),f.enableVariableInterpolation&&(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Supports variable interpolation, conditional content, and formatting. Use `","{","if @variable","}","content","{/if}","` for conditions."]})]}),"output-results"===s.type&&(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Header Image (optional)"}),(0,a.jsx)(ep,{value:f.headerImage||null,onChange:T,placeholder:"Add a header image to your results page",enableSizing:!0,enablePositioning:!1,className:"mt-1"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Variable Interpolation"}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(m.d,{checked:!1!==f.enableVariableInterpolation,onCheckedChange:R,id:"enable-interpolation"}),(0,a.jsx)(o.J,{htmlFor:"enable-interpolation",className:"text-sm text-gray-600",children:"Enable dynamic content with variables"})]}),!1!==f.enableVariableInterpolation&&(0,a.jsxs)("div",{className:"space-y-3 pl-6 border-l-2 border-emerald-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>k(!C),children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),C?"Edit Mode":"Preview Mode"]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>w(!y),children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-1"}),"Debug Info"]})]}),V.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 mb-2",children:"Available Variables:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1",children:[V.slice(0,10).map((e,s)=>(0,a.jsxs)(d.E,{variant:"outline",className:"text-xs bg-blue-50 text-blue-700",children:["@",e.name]},s)),V.length>10&&(0,a.jsxs)(d.E,{variant:"outline",className:"text-xs text-gray-500",children:["+",V.length-10," more"]})]})]})]})]}),"output-download"===s.type&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Download Settings"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600",children:"File URL"}),(0,a.jsx)(c.p,{value:f.fileUrl||"",onChange:e=>v({settings:{...f,fileUrl:e.target.value}}),placeholder:"https://example.com/file.pdf"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600",children:"File Name"}),(0,a.jsx)(c.p,{value:f.fileName||"",onChange:e=>v({settings:{...f,fileName:e.target.value}}),placeholder:"resource.pdf"})]})]})]}),"output-redirect"===s.type&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(o.J,{className:"text-sm font-medium text-gray-700",children:"Redirect Settings"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600",children:"Redirect URL"}),(0,a.jsx)(c.p,{value:f.url||"",onChange:e=>v({settings:{...f,url:e.target.value}}),placeholder:"https://example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(o.J,{className:"text-xs text-gray-600",children:"Delay (seconds)"}),(0,a.jsx)(c.p,{type:"number",value:f.delay||0,onChange:e=>v({settings:{...f,delay:parseInt(e.target.value)||0}}),placeholder:"0"})]})]})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsx)(o.J,{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Responsive Preview"}),(0,a.jsx)(eC,{enableDeviceToggle:!0,enableOrientationToggle:!0,showDeviceFrame:!0,defaultDevice:"desktop",className:"scale-90 origin-top-left",children:(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(ek,{section:s,isPreview:!0,onUpdate:v})})})]})]})}},82714:(e,s,t)=>{t.d(s,{J:()=>n});var a=t(95155);t(12115);var l=t(40968),i=t(53999);function n(e){let{className:s,...t}=e;return(0,a.jsx)(l.b,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}},88633:(e,s,t)=>{t.d(s,{i$:()=>i,iB:()=>n}),t(95155);var a=t(12115);let l=(0,a.createContext)(void 0);function i(){let e=(0,a.useContext)(l);if(!e)throw Error("useCapture must be used within a CaptureProvider");return e}function n(){let{captureState:e,isCaptureRequired:s}=i();return{isResultsLocked:s&&!e.isCompleted,canAccessResults:!s||e.isCompleted,captureCompleted:e.isCompleted,leadId:e.leadId}}},89852:(e,s,t)=>{t.d(s,{p:()=>n});var a=t(95155),l=t(12115),i=t(53999);let n=l.forwardRef((e,s)=>{let{className:t,type:l,...n}=e;return(0,a.jsx)("input",{type:l,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...n})});n.displayName="Input"},90088:(e,s,t)=>{t.d(s,{d:()=>n});var a=t(95155);t(12115);var l=t(4884),i=t(53999);function n(e){let{className:s,...t}=e;return(0,a.jsx)(l.bL,{"data-slot":"switch",className:(0,i.cn)("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:(0,a.jsx)(l.zi,{"data-slot":"switch-thumb",className:(0,i.cn)("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}},92220:(e,s,t)=>{t.d(s,{v:()=>l});var a=t(12115);function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{autoSave:t=!0,autoSaveDelay:l=500,validation:i,onSave:n,onCancel:r,onEdit:c,placeholder:o="",multiline:d=!1,maxLength:m,required:x=!1}=s,[u,h]=(0,a.useState)(!1),[p,g]=(0,a.useState)(e),[b,v]=(0,a.useState)(null),[j,f]=(0,a.useState)(!1),[N,y]=(0,a.useState)(e),w=(0,a.useRef)(null),C=function(e,s){let[t,l]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let t=setTimeout(()=>{l(e)},s);return()=>{clearTimeout(t)}},[e,s]),t}(p,l),k=p!==N;(0,a.useEffect)(()=>{u||e===N||(g(e),y(e))},[e,u,N]);let V=(0,a.useCallback)(e=>x&&!e.trim()?"This field is required":m&&e.length>m?"Maximum length is ".concat(m," characters"):i?i(e):null,[x,m,i]);(0,a.useEffect)(()=>{t&&u&&k&&!b&&(V(C)||S())},[C,t,u,k,b,V]),(0,a.useEffect)(()=>{u&&v(V(p))},[p,u,V]);let A=(0,a.useCallback)(()=>{h(!0),y(p),v(null),null==c||c(),setTimeout(()=>{var e;null==(e=w.current)||e.focus(),w.current&&"select"in w.current&&w.current.select()},0)},[p,c]),S=(0,a.useCallback)(async()=>{if(b)return;let e=V(p);if(e)return void v(e);try{f(!0),await (null==n?void 0:n(p)),y(p),h(!1),v(null)}catch(e){v(e instanceof Error?e.message:"Failed to save")}finally{f(!1)}},[p,b,V,n]),z=(0,a.useCallback)(()=>{g(N),h(!1),v(null),null==r||r()},[N,r]),T=(0,a.useCallback)(e=>{switch(e.key){case"Enter":(!d||d&&e.ctrlKey)&&(e.preventDefault(),S());break;case"Escape":e.preventDefault(),z();break;case"Tab":b||S()}},[S,z,d,b]),R=(0,a.useCallback)(()=>{!b&&k?S():k||h(!1)},[b,k,S]),E=p||o;return{isEditing:u,value:p,displayValue:E,error:b,isSaving:j,isDirty:k,startEdit:A,save:S,cancel:z,setValue:g,handleKeyDown:T,handleBlur:R,inputRef:w}}},99474:(e,s,t)=>{t.d(s,{T:()=>i});var a=t(95155);t(12115);var l=t(53999);function i(e){let{className:s,...t}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}}}]);